"use strict";(self.webpackChunklath_docs=self.webpackChunklath_docs||[]).push([[724],{724:(t,e,i)=>{i.r(e),i.d(e,{E:()=>g,S:()=>L,i:()=>u,r:()=>r,s:()=>s});var s,n,o,r,l,a,h,c,p,d,u,v=i(497);function m(){return!(!("scrollSnapAlign"in document.documentElement.style||"webkitScrollSnapAlign"in document.documentElement.style||"msScrollSnapAlign"in document.documentElement.style)||!(0,v.a)())}const w=Symbol("__EventGroupName__");class g{constructor(){this._events={}}on(t,e,i){return Object.defineProperty(e,w,{value:i,writable:!0}),this._events[t]||(this._events[t]=[]),null!=(i=this._events[t])&&i.push(e),this}one(t,e,i){const s=(...i)=>{e(...i),this.off(t,s)};return Object.defineProperty(s,w,{value:i,writable:!0}),this._events[t]||(this._events[t]=[]),null!=(i=this._events[t])&&i.push(s),this}off(t,e){var i;return!this._events[t]||-1<(e=null!=(i=null==(i=this._events[t])?void 0:i.indexOf(e))?i:-1)&&null!=(i=this._events[t])&&i.splice(e,1),this}removeEventGroup(t){var e=e=>null==(e=this._events[e])?void 0:e.filter((e=>e[w]!==t));for(const t in this._events)this._events[t]=e(t);return this}trigger(t,...e){var i;return this._events[t]&&null!=(i=this._events[t])&&i.forEach((i=>{try{i(...e)}catch(e){this.off(t,i),this.trigger("error",e)}})),this}}class f extends g{constructor(t,e,i){super(),this.param="",this.slide=null,this.modality=null,this.view=null,this.img=null,this.snapshot=null,this.snapshotTime=-1,this.visitTime=-1,this.events={transformStart:()=>{},transformEnd:()=>{},boot:()=>{},load:()=>{},loadError:()=>{},preload:()=>{},destroy:()=>{}},this.darkTask=[],this.createTime=Date.now(),this.transient=!1,this.config={title:"",level:0,source:{},prerender:[],apply:["smart-setTimeout","smart-setInterval","link-new-viewport","tap-highlight"],background:"auto",free:!1},this.components=[],this.resources={script:[],image:[],worker:[],video:[],audio:[],font:[],style:[]},this.id=t,this.model=e,this.application=i;var{config:i,resources:e,events:t,components:s}=this.setDefaultConfig(e,t);Object.assign(this.config,i),Object.assign(this.resources,e),Object.assign(this.events,t),s&&(this.components=s)}get self(){return this.application.applets[this.id]||this}setBaseCss(){var t=document.createElement("style");t.innerHTML="\n      body::-webkit-scrollbar {\n        display: none;\n      }\n      body::scrollbar {\n        display: none;\n      }\n    ",document.getElementsByTagName("head")[0].appendChild(t)}setDefaultConfig(t,e){var i=t.config;if("frameworks"!==e&&"system"!==e||(i.free&&(0,v.t)(1101,"warn"),(null!=(e=i.source)&&e.html||null!=(e=i.source)&&e.src)&&(0,v.t)(1102,"warn")),!i.portal||i.free||(0,v.t)(1103,"warn"),void 0===i.level&&(0,v.t)(1104,"warn"),1e4<(null!=(e=i.level)?e:0)&&(0,v.t)(1105,"warn"),null!=(e=null==i?void 0:i.unApply)&&e.length){const t=i.unApply;this.config.apply=null==(e=this.config.apply)?void 0:e.filter((e=>!t.includes(e)))}return 0===(null==(e=i.modality)?void 0:e.indexOf("sheets:"))&&(i.animation&&(0,v.t)(1106,"warn"),i.animation="sheets-bottom"),t}}class y extends f{constructor(){super(...arguments),this.visibility=!1,this.transforming=!1,this.viewLevel=0,this.status={preload:!1,prefetch:!1,prerender:!1,refreshing:!1,requestRefresh:!1,presetElements:!1}}resume(){this.status={preload:!1,prefetch:!1,prerender:!1,refreshing:!1,requestRefresh:!1,presetElements:!1},this.darkTask=[],this.view=null,this.img=null}get swipeModel(){var t;return!!(null!=(t=this.application.config.swipeModel)?t:"ontouchend"in document)}get sameOrigin(){return this.uri?new URL(this.uri,window.location.toString()).host===location.host:void 0===this.config.sandbox||!!this.config.sandbox.includes("allow-same-origin")}get level(){var t;return null!=(t=this.config.level)?t:0}setLevel(t){this.viewLevel=t}get rel(){return"system"===this.id?"system":"frameworks"===this.id?"frameworks":"applet"}get uri(){var t;return(null==(t=null==(t=this.config)?void 0:t.source)?void 0:t.src)||""}get source(){var t=(null==(t=null==(t=this.config)?void 0:t.source)?void 0:t.html)||"";return"string"==typeof t?t:t()}get hasSource(){var t;return!!(this.uri||null!=(t=null==(t=this.config)?void 0:t.source)&&t.html)}get noSource(){return!this.hasSource&&!this.config.render}get viewType(){var t;return"applet"===this.rel&&this.hasSource?null!=(t=this.config)&&t.portal&&this.sameOrigin?"portal":"iframe":"shadow"}get color(){var t,e;return"applet"!==this.rel?"transparent":(e=(t=this.application).properties.darkTheme,e=""+(this.config.color||(e?"#000":"#fff")),"frameworks"!==this.id&&"inherit"==e&&t.applets.frameworks.config.color||e)}get expired(){var t;return!(!this.view||null!=(t=this.application.prevActivityApplet)&&t.config.modality||!(this.status.requestRefresh||Date.now()-this.createTime>=(null!=(t=this.config.timeout)?t:6e7)))}get isModality(){return!!this.config.modality}get isFullscreen(){return!this.isModality}get isPresetAppletsView(){return this.application.checkIsPresetAppletsView(this.id)}get useControls(){return!0!==this.config.disableSwipeModel&&this.swipeModel&&"applet"===this.rel&&this.isFullscreen}get noShadowDom(){return"shadow"===this.viewType&&!!this.config.noShadowDom}get mirroringString(){try{return localStorage.getItem("__MODULE_IMG__"+this.id)||""}catch(t){return""}}get contentWindow(){var t;return null!=(t=null==(t=null==(t=this.sandbox)?void 0:t.window)?void 0:t.window)?t:window}get contentDocument(){var t;if(this.sameOrigin)return"shadow"===this.viewType?this.viewport:null==(t=this.sandbox)?void 0:t.document}get mirroringHTML(){if("shadow"===this.viewType)return null!=(t=null==(t=this.view)?void 0:t.outerHTML)?t:"";if(!this.sameOrigin)return"";var t=null==(t=this.sandbox)?void 0:t.sandbox;const e=["script","template"];try{var i=t.contentDocument;if(!i)return"";var s=i.querySelectorAll("*");const n=[];return s.forEach((t=>{var i=t.tagName;e.includes(i)||(-1!==i.indexOf("-")&&(t.style.visibility="hidden"),n.push(t.outerHTML))})),n.join("\n")}catch(t){return""}}saveMirroring(){if(!this.config.useMirroring||!this.sameOrigin)return Promise.resolve(!1);var t="__MODULE_IMG__"+this.id,e=null!=(e=this.mirroringHTML)?e:"";try{return localStorage.setItem(t,e),Promise.resolve(!0)}catch(i){return localStorage.clear(),localStorage.setItem(t,e),Promise.resolve(!1)}}setActionOrigin(t){t&&(this.actionOriginMap=t)}getActionOrigin(){return this.actionOriginMap}injectWindowVisibilityState(t){var e;this.sameOrigin&&(e=this.contentWindow)&&(e.appletVisibilityState=t)}triggerWindow(t){var e;null!=(e=this.contentWindow)&&e.postMessage({type:t,appletId:this.id,historyDirection:this.application.segue.historyDirection},"*")}}s=window.setBackgroundTimeout||window.setTimeout,n=window.setBackgroundInterval||window.setInterval,o=window.requestIdleCallback||((t,e)=>{const i=Date.now();return s((function(){t({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-i))}})}),Math.min(null!=(e=null==e?void 0:e.timeout)?e:1,1))}),r=window.requestAnimationFrame||s;class b extends y{attach(t,e,i){t&&(this.viewport=t,this.parentApplet=e,this.mountBehavior=i)}removeContainer(){var t;this.isPresetAppletsView||(null!=(t=null==(t=this.contentView)?void 0:t.parentElement)&&t.removeChild(this.contentView),null!=(t=null==(t=this.viewport)?void 0:t.parentNode)&&t.removeChild(this.viewport)),this.viewport=void 0,this.delPresetView()}clearContainer(){var t;this.isPresetAppletsView||null!=(t=null==(t=this.contentView)?void 0:t.parentElement)&&t.removeChild(this.contentView),this.viewport&&(this.viewport.innerHTML=""),this.delPresetView()}delPresetView(){this.contentView=void 0,this.application.delPresetAppletsView(this.id)}setParam(t){return this.param!==t?(this.param=t,this.destroy(!0)):Promise.resolve(!0)}show(){var t,e=this.viewType;if("portal"===e)null!=(t=this.view)&&t.activate();else{for(const t of this.darkTask)t();this.transforming=!1,this.darkTask=[],this.visibility=!0,this.visitTime=Date.now(),this.trigger("show"),"iframe"===e&&(this.triggerWindow("applet-show"),this.injectWindowVisibilityState("visible"))}}hide(){this.transforming=!1,this.visibility=!1,this.trigger("hide"),"iframe"===this.viewType&&(this.triggerWindow("applet-hidden"),this.injectWindowVisibilityState("hidden"))}willShow(){this.transforming=!0,this.trigger("willShow"),"iframe"===this.viewType&&(this.triggerWindow("applet-will-show"),this.injectWindowVisibilityState("willVisible"))}willHide(){this.transforming=!0,this.trigger("willHide"),"iframe"===this.viewType&&(this.triggerWindow("applet-will-hide"),this.injectWindowVisibilityState("willHidden"))}willSegueShow(){this.trigger("willSegueShow")}willSegueHide(){this.trigger("willSegueHide")}destroy(t=!1){return new Promise((e=>{var i;return this.view?!0===this.status.presetElements||"frameworks"===this.rel||"system"===this.rel||(null==(i=this.application.segue)?void 0:i.id)===this.id&&!1===t?e(!1):("iframe"===this.viewType&&this.unload(),!1===t?this.removeContainer():this.clearContainer(),this.resume(),null!=(i=this.events)&&i.destroy(this.self),this.application.removeEventGroup(this.id),this.trigger("destroy"),void e(!0)):e(!0)}))}observer(t){var e,i=this.sandbox?null==(i=this.sandbox.document)?void 0:i.documentElement:this.view;if(i)return(e=new MutationObserver((e=>{t(e)}))).observe(i,{subtree:!0,attributes:!0,childList:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0}),e}collectAllElements(t){function e(t){for(let n=0;n<t.length;n++){var s=t[n];i.push(s),s.shadowRoot&&e(s.shadowRoot.querySelectorAll("*"))}}const i=[];return t.shadowRoot&&e(t.shadowRoot.querySelectorAll("*")),e(t.querySelectorAll("*")),i}autoMediaController(t){return new Promise(((e,i)=>{try{if("iframe"!==this.viewType)return e();if(void 0===this.sandbox)return e();var s=t.filter((t=>"video"===t.tagName||"audio"===t.tagName));for(const t in s){const e=s[t];null!=e&&e.paused||(e.pause(),this.darkTask.push((()=>{e.play()})))}}catch(e){i()}}))}destructiveTags(t){const e=["object","embed","applet","iframe"];return!!t.filter((t=>e.includes(t.tagName))).length}guarding(){return new Promise((t=>{var e;if("applet"!==this.rel)return t(!0);if(!0===this.config.background)return t(!0);if(!1===this.config.background)return t(!1);if("iframe"!==this.viewType)return t(!0);if(void 0===this.sandbox)return t(!0);if(!1===this.sameOrigin)return t(!1);var i=this.view;try{var n=null==(e=i.contentDocument)?void 0:e.documentElement;if(!n)return t(!0);var o=this.collectAllElements(n);if(!1!==this.config.mediaGuard&&this.autoMediaController(o).catch(t),this.destructiveTags(o))return t(!1);const l={times:0};var r=this.observer((()=>{l.times++,1e3<l.times&&(t(!1),this.mutationObserver.disconnect())}));r&&(this.mutationObserver=r,s((()=>{10<l.times&&t(!1)}),3e3))}catch(e){t(!0)}}))}cancelGuard(){var t;null!=(t=this.mutationObserver)&&t.disconnect()}unload(t){var e;return void 0===t&&(t=null==(e=this.sandbox)?void 0:e.sandbox),new Promise((e=>{var i,s;if(this.cancelGuard(),!t)return e();t===(null==(s=this.sandbox)?void 0:s.sandbox)&&this.saveMirroring();try{t.contentWindow&&(t.contentWindow.onunload=null),t.style.display="none",t.src="about:blank";var n=null==(i=t.contentWindow)?void 0:i.window,o=t.contentDocument;null!=n&&n.location.reload(),null!=o&&o.open(),null!=o&&o.write(""),null!=o&&o.close()}catch(e){}null!=(s=t.parentNode)&&s.removeChild(t),e()}))}}class S{constructor(t,e){var i=this.sandbox=document.createElement("iframe");return i.src=t||"about:blank",i.style.display="none",void 0!==e&&this.set(e),this}get window(){return this.sandbox.contentWindow}get document(){return this.sandbox.contentDocument}set src(t){this.sandbox.src=t}set onunload(t){this.window.onunload=t}set onload(t){this.sandbox.onload=t}set onerror(t){this.sandbox.onerror=t}set(t){this.sandbox.setAttribute("sandbox",t)}reset(t){return this.exit(),this.set(t),this}open(){var t;return null!=(t=this.document)&&t.open(),this}write(t='<head><meta charset="utf-8"></head>'){var e;return t="<!DOCTYPE html>"+t,null!=(e=this.document)&&e.write(t),this}close(){var t;return null!=(t=this.document)&&t.close(),this}append(t,e){this.enter(e),this.open(),this.write(t),this.close()}enter(t){t.appendChild(this.sandbox)}exit(){var t=this.sandbox.parentNode;t&&t.removeChild(this.sandbox)}}class x extends b{dependenciesLoad(t,e){return new Promise(((i,s)=>{var n=document.head;const o=new S(t,"");o.onload=t=>{o.exit(),i(t)},o.onerror=t=>{o.exit(),s(t)},t?o.enter(n):e?o.append(e,n):s()}))}preload(){return(0,v._)(this,void 0,void 0,(function*(){return this.dependenciesLoad(this.uri,yield this.source).then((()=>{var t;this.status.preload=!0,null!=(t=this.events)&&t.preload(this.self),this.trigger("preload")}))}))}prefetch(){return new Promise(((t,e)=>{Promise.all([this.prefetchStatic(this.resources.script,"script"),this.prefetchStatic(this.resources.image,"image"),this.prefetchStatic(this.resources.worker,"worker"),this.prefetchStatic(this.resources.video,"video"),this.prefetchStatic(this.resources.audio,"audio"),this.prefetchStatic(this.resources.font,"font"),this.prefetchStatic(this.resources.style,"style"),this.prefetchStatic(this.resources.html,"document")]).then((()=>{this.status.prefetch=!0,this.trigger("prefetch"),t(!0)})).catch(e)}))}prefetchStatic(t=[],e="script"){return new Promise(((i,s)=>{Promise.all([].concat(t).map((t=>this.prelink(t,"preload",e)))).then(i).catch(s)}))}prelink(t,e="preload",i="worker | video | audio | font | script | style | image | document"){return t?new Promise(((s,n)=>{o((()=>{var o,r=document.createElement("link");if(r.rel=e,r.href=t,r.as=i,r.onload=s,r.onerror=n,"preload"===e&&"document"===i&&this.dependenciesLoad(t),null==(o=r.relList)||!o.supports(e))return s(void 0);document.getElementsByTagName("head")[0].appendChild(r),s(void 0)}),{timeout:15e3})})):Promise.resolve(void 0)}prerender(){return this.status.preload||this.status.prerender?Promise.resolve():new Promise(((t,e)=>{this.preload().then(t).catch(e),this.prefetch(),this.prelink(this.uri,"prerender","document")}))}}class T extends x{constructor(){super(...arguments),this.borderHolder=[],this.getTouchBorderType=t=>{var e=(i=this.viewport).offsetWidth,i=i.offsetHeight,s=(t=t.touches[0]).clientX,n=(t=t.clientY,[]),o=null!=(o=this.config.borderTouchSize)?o:100;return s<=o?n.push("left"):e-o<=s&&n.push("right"),t<=o?n.push("top"):i-o<=t&&n.push("bottom"),n}}attachEvent(){this.registerBorderTouch(),this.bindOverscrollHistoryNavigation(),this.registerTapStatusBarToScrollToTop(),this.registerPullToRefresh()}scrollToTop(){const t=this.getMainScroller();t&&Promise.resolve().then((function(){return l})).then((({SmoothScroller:e})=>{new e(t).scrollTo(0,0)})).catch((t=>{console.warn(t)}))}registerPullToRefresh(){if(this.config.pullToRefresh)if(this.application.pullRefreshHolder.holder){const t=this.application.pullRefreshHolder.holder,e=this.application.pullRefreshHolder.spinner,s=this.application.pullRefreshHolder.holdLayer,n=this.getMainScroller(this.config.pullToRefreshTargetScrollId);n&&i.e(129).then(i.bind(i,129)).then((i=>{i.registerPullDownEvent(this.self,n,t,e,s)})).catch((t=>{console.warn(t)}))}else this.application.on("pullToRefreshAvailable",(()=>{this.registerPullToRefresh()}))}registerTapStatusBarToScrollToTop(){this.config.tapStatusBarToScrollToTop&&this.borderHolder[0].addEventListener("touchend",(()=>{this.scrollToTop()}))}getMainScroller(t=this.config.mainScrollId){var e;let i;return"shadow"===this.viewType?i=t?(null==(e=null==(e=this.view)?void 0:e.shadowRoot)?void 0:e.getElementById(t))||document.getElementById(t):this.contentView:this.sameOrigin&&(e=null==(e=this.sandbox)?void 0:e.window,i=t?null==e?void 0:e.document.getElementById(t):null==e?void 0:e.document.body),i}bindOverscrollHistoryNavigation(){this.on("touchBorder",((t,e)=>{"touchmove"===e.type&&(t.includes("left")||t.includes("right")||t.includes("wipe"))&&(this.application.overscrollHistoryNavigation.moment=Date.now(),this.application.overscrollHistoryNavigation.type=t.join(" "))}))}addBorderPanMoveHolder(t){var e=null!=(e=this.config.borderTouchSize)?e:15,i=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),r=document.createElement("div");return i.style.cssText=`position: absolute; z-index: 3; top: 0; right: 0; left: 0; height: env(safe-area-inset-top); mini-height: ${e}px;`,s.style.cssText=`position: absolute; z-index: 3; top: 0; right: 0; bottom: 0; z-index: 3; width: ${e}px;`,n.style.cssText=`position: absolute; z-index: 3; right: 0; bottom: 0; left: 0; z-index: 3; height: ${e}px;`,o.style.cssText=`position: absolute; z-index: 3; top: 0; bottom: 0; left: 0; z-index: 3; width: ${e}px;`,r.style.cssText="display: none; position: absolute; z-index: 3; top: 0; right: 0; bottom: 0; left: 0; z-index: 4;",t.appendChild(i),t.appendChild(s),t.appendChild(n),t.appendChild(o),t.appendChild(r),this.borderHolder=[i,s,n,o,r]}registerBorderHolderTouch(){const[t,e,i,s,n]=this.addBorderPanMoveHolder(this.viewport),o=[],r=n.addEventListener,l=n.removeEventListener,a=t=>{this.trigger("touchBorder",o,t)},h=l=>{o.length=0,l.target===t?o.push("top"):l.target===e?o.push("right"):l.target===i?o.push("bottom"):l.target===s&&o.push("left"),n.style.display="block",r("touchmove",a,!0),r("touchend",a,!0),r("touchcancel",a,!0)},c=()=>{n.style.display="none",l("touchmove",a,!0),l("touchend",a,!0),l("touchcancel",a,!0)};var p=t=>{(t=t.addEventListener)("touchstart",h,!0),t("touchmove",h,!0),t("touchcancel",c,!0),t("touchend",c,!0)};p(t),p(e),p(i),p(s)}registerBorderTouch(){var t;if(this.sandbox&&!this.sameOrigin)return this.registerBorderHolderTouch();const e=(null==(t=null==(t=this.sandbox)?void 0:t.window)?void 0:t.document)||this.viewport,i=[],s=t=>{this.trigger("touchBorder",i,t),"touchend"!==t.type&&"touchcancel"!==t.type||(e.removeEventListener("touchmove",s,!0),e.removeEventListener("touchend",s,!0),e.removeEventListener("touchcancel",s,!0))};e.addEventListener("touchstart",(t=>{i.length=0,i.push(...this.getTouchBorderType(t)),this.transforming&&i.push("wipe"),0<i.length&&(e.addEventListener("touchmove",s,!0),e.addEventListener("touchend",s,!0),e.addEventListener("touchcancel",s,!0))}),!0)}}const V=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,A=(0,v.a)(),k=m(),C=!A&&/Mac OS X [0-9][0-9]_/g.exec(navigator.userAgent);class L{constructor(t,e=!1){this.touchHold=!1,this.scrollType="scroll",this.scrollHold=null,this.scrolling=!1,this.reservePlanId=-1,this.checkScrollEnd=(t,e)=>this.element.scrollLeft===t&&this.element.scrollTop===e,this.element=t,!A&&e&&(t.addEventListener("touchstart",this.scrollStop,!0),t.addEventListener("touchend",this.scrollContinue,!0),t.addEventListener("touchcancel",this.scrollContinue,!0))}snapTo(t,e){return(0,v._)(this,void 0,void 0,(function*(){return this.touchHold=!1,this.scrollType="snap",this.smoothScroll(t,e)}))}scrollTo(t,e){return(0,v._)(this,void 0,void 0,(function*(){return this.touchHold=!1,this.scrollType="scroll",this.smoothScroll(t,e)}))}scrollStop(){this.touchHold=!0}scrollContinue(){var t;this.touchHold=!1,null!=(t=this.scrollHold)&&t.call(this)}catchDefaultStyle(){var t;!0!==this.scrolling&&(t=this.element.style,this.defaultScrollBehavior=t.scrollBehavior||"smooth")}isBreak(){return!("ontouchstart"in document.documentElement||void 0===this.preStep||this.preStep[0]===this.element.scrollLeft&&this.preStep[1]===this.element.scrollTop||(this.scrollStop(),0))}step(t){if(this.touchHold){if("scroll"===this.scrollType)return t.end();this.scrollHold=()=>{this.step(t)}}var e=V();e=(t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2)(e=Math.min((e-t.startTime)/400,1));let i=t.startX+(t.x-t.startX)*e,s=t.startY+(t.y-t.startY)*e;e=0<t.x-t.startX?1:-1;var n=0<t.y-t.startY?1:-1;(1==e&&i>t.x||-1==e&&i<t.x)&&(i=t.x),(1==n&&s>t.y||-1==n&&s<t.y)&&(s=t.y),this.isBreak()||(this.element.scrollLeft=i,this.element.scrollTop=s,this.element.scrollTo(i,s),this.preStep=[this.element.scrollLeft,this.element.scrollTop],i!==t.x||s!==t.y?r((()=>{this.step(t)})):(t.end(),this.scrollHold=null))}openSmooth(){this.element.style.scrollBehavior="smooth",C&&(this.element.style.scrollSnapType=this.defaultScrollSnapType)}closeSmooth(){this.element.style.scrollBehavior="auto",C&&(this.defaultScrollSnapType=this.element.style.scrollSnapType,this.element.style.scrollSnapType="none")}scrollStart(){this.catchDefaultStyle(),this.preStep=void 0,this.scrolling=!0}scrollEnd(){this.element.style.scrollBehavior=this.defaultScrollBehavior||"smooth",this.scrolling=!1}smoothScroll(t,e){if("scroll"===this.scrollType&&!A||"snap"===this.scrollType&&!k)return this.smoothScrollByStep(t,e);let i=-1;return new Promise((n=>{const o=()=>{clearTimeout(i),i=s((()=>(0,v._)(this,void 0,void 0,(function*(){this.element.removeEventListener("scroll",o,!1),n()}))),100)};this.element.addEventListener("scroll",o,!1),this.scrollStart(),this.openSmooth(),this.checkScrollEnd(t,e)&&(this.scrollEnd(),n()),this.element.scrollTo(t,e),clearTimeout(this.reservePlanId),this.reservePlanId=s((()=>(0,v._)(this,void 0,void 0,(function*(){-1===i&&(yield this.smoothScrollByStep(t,e),n())}))),600)}))}smoothScrollByStep(t,e){return this.scrollStart(),this.closeSmooth(),new Promise((i=>{this.step({startTime:V(),startX:this.element.scrollLeft,startY:this.element.scrollTop,x:t,y:e,end:()=>{this.scrollEnd(),i()}})}))}}l=Object.freeze({__proto__:null,SmoothScroller:L});const P="\n  width: 100%;\n  height: 100%;\n  min-width: 100%;\n  min-height: 100%;\n  max-width: 100%;\n  max-height: 100%;\n",E=`\n  inset: 0px;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  ${P}\n`;class I{constructor(t){this.available=!0,this.toggleLock=!1,this.advanceDegree=.03,this.applet=t,this.application=t.application,this.appletViewport=this.applet.viewport}get visibility(){return 0!==Math.round(this.controlsView.scrollLeft/this.appletViewport.offsetWidth)}get viewports(){return this.fromViewports||(this.fromViewports=this.application.segue.viewports)}get historyBack(){return-1===this.application.segue.prevHistoryStep}get degree(){return this.controlsView.scrollLeft/this.appletViewport.offsetWidth}attach(){this.controlsView=document.createElement("applet-controls"),this.contentContainer=document.createElement("applet-container"),this.dropbackView=document.createElement("applet-dropback"),this.controlsOverlay=document.createElement("applet-controls-overlay"),this.scroll=new L(this.controlsView),this.bindControlsOverlay()}bindControlsOverlay(){this.controlsOverlay.addEventListener("touchstart",(t=>{t.stopPropagation(),t.preventDefault()}),!1)}setControlView(){var t=`\n      display: flex;\n      ${P}\n      scroll-snap-align: start;\n      scroll-snap-stop: always;\n    `,e=document.createElement("style");e.innerHTML="\n      applet-controls::-webkit-scrollbar {\n        display: none;\n      }\n      applet-controls::scrollbar {\n        display: none;\n      }\n    ",this.contentContainer.style.cssText=t,this.dropbackView.style.cssText=`\n      ${t}\n      background: rgba(0, 0, 0, .3);\n      opacity: 0;\n    `,this.controlsView.style.cssText=`\n      display: flex;\n      ${P}\n      flex-direction: row;\n      overflow: auto;\n      scroll-behavior: auto;\n      scroll-snap-type: both mandatory;\n    `,!1===(0,v.b)()&&(this.controlsView.style.cssText+="-webkit-overflow-scrolling: touch;"),this.controlsOverlay.style.cssText=`\n      position: fixed;\n      ${E}\n      z-index: 9;\n      display: none;\n    `,this.controlsView.appendChild(this.dropbackView),this.controlsView.appendChild(this.contentContainer),this.appletViewport.appendChild(e),this.appletViewport.appendChild(this.controlsView),this.appletViewport.appendChild(this.controlsOverlay)}bindEvent(){const t=this.applet,e=this.viewports[1],i=this.application.config.swipeTransitionType,n=e=>{t.transforming||!1===this.toggleLock&&e<=this.advanceDegree&&this.application.activityApplet===t&&(this.toggleLock=!0,s((()=>{this.toggleLock=!1}),300),this.application.segue.back("controls").then((()=>{this.fromViewports=void 0})))};this.controlsView.addEventListener("scroll",(()=>{const s=this.degree;n(s),r((()=>{this.dropbackView.style.opacity=""+s,this.controlsView.style.backgroundColor=1<s?`rgba(0, 0, 0, ${.5+3*(s-1)})`:"transparent",this.application.trigger("transitioning",s,this.application.segue.appletGroup),e&&t.visibility&&!t.transforming&&!this.toggleLock&&(e.style.transform="slide"===i?`translate3d(${30*-s}%, 0, 0)`:`scale(${1-.03*s})`)}))})),this.dropbackView.addEventListener("touchstart",(()=>(0,v._)(this,void 0,void 0,(function*(){yield this.hide(),n(this.degree)})))),this.applet.on("show",(()=>{this.visibility||this.appearImmediately(),this.prepareForChange()})),this.applet.on("hide",(()=>{this.visibility&&this.historyBack&&this.disappearImmediately()}))}prepareForChange(){var t=this.viewports,e=this.application.config.swipeTransitionType;(t=t[1])&&(t.style.transform="slide"===e?"translate3d(30%, 0, 0)":"scale(0.97)")}switch(t){return(0,v._)(this,void 0,void 0,(function*(){return this.controlsOverlay.style.display="block",t&&this.disappearImmediately(),this.toggleLock=!0,this.scroll.snapTo(t?this.appletViewport.offsetWidth:0,0).then((()=>{this.toggleLock=!1,this.controlsOverlay.style.display="none"}))}))}disappearImmediately(){this.controlsView.style.scrollBehavior="auto",this.controlsView.scrollLeft=0}appearImmediately(){this.controlsView.style.scrollBehavior="auto",this.controlsView.scrollLeft=this.appletViewport.offsetWidth}show(){return this.switch(!0)}hide(){return this.switch(!1)}disable(){this.freeze(),this.available=!1}enable(){this.available=!0}activate(){!1!==this.available&&(this.dropbackView.style.display="block",this.controlsView.style.overflow="auto",this.controlsView.scrollLeft=this.appletViewport.offsetWidth)}freeze(){this.dropbackView.style.display="none",this.controlsView.style.overflow="hidden"}create(){this.attach(),this.setControlView(),this.bindEvent();var t=this.applet;return("applet"!==t.rel||!1===t.swipeModel||null!=(t=t.mountBehavior)&&t.noSwipeModel)&&this.freeze(),this.contentContainer}}class H{constructor(t,e={openSlideViewLeftHolder:!0,slideViewSnapType:"x",slideViewGridRepeat:0}){this.scrolling=!1,this.switching=!1,this.distance=0,this.activeId="",this.hasSmoothSnapScrolling=m(),this.scrollCancelTimeoutId=-1,this.scrollCycleTimeout=300,this.snapType="x";var i=t.config.defaultSlideViewApplets,s=t.viewport;i&&s&&(this.applet=t,this.application=t.application,this.slideViewApplets=i,this.options=e,this.snapType=e.slideViewSnapType,this.createSlideView(i,s),this.bindScroll(),this.bindSlideViewHolder(),this.scroller=new L(this.slideView))}get index(){var t=this.slideView;return(Math.round(t.scrollLeft/t.offsetWidth)+1)*(Math.round(t.scrollTop/t.offsetHeight)+1)-1}closeOverlay(){this.slideViewOverlay.style.display="none"}openOverlay(){this.slideViewOverlay.style.display="block"}bindSlideViewHolder(){var t=t=>{t.stopPropagation(),this.openOverlay(),this.slideView.style.overflowX="hidden"};const e=()=>{this.closeOverlay(),this.slideView.style.overflowX="auto",this.slideView.removeEventListener("touchcancel",e,!0),this.slideView.removeEventListener("touchend",e,!0)};this.slideViewHolder.addEventListener("touchstart",t,!0),this.slideViewHolder.addEventListener("touchmove",t,!0),this.slideViewHolder.addEventListener("touchcancel",e,!0),this.slideViewHolder.addEventListener("touchend",e,!0)}bindScroll(){const t=this.slideView;t.addEventListener("scroll",(()=>{if(!this.switching){this.scrolling||(this.freezeAll(),this.scrolling=!0);const e={get x(){return t.scrollLeft},get y(){return t.scrollTop},get xIndex(){return Math.round(t.scrollLeft/t.offsetWidth)},get yIndex(){return Math.round(t.scrollTop/t.offsetHeight)}};this.application.activate(!1),this.applet.trigger("sliding",e),clearTimeout(this.scrollCancelTimeoutId),this.scrollCancelTimeoutId=s((()=>(0,v._)(this,void 0,void 0,(function*(){this.hasSmoothSnapScrolling||(yield this.scroller.scrollTo(e.xIndex*this.slideView.offsetWidth,e.yIndex*t.offsetHeight)),this.scrolling=!1,this.activate(this.index),this.application.activate(!0)}))),this.scrollCycleTimeout)}}))}getAppletIdByIndex(t){return null==(t=this.slideViewApplets[t])?void 0:t.id}getAppletIndexById(t){if("number"==typeof t)return t;let e=0;for(const i of this.slideViewApplets){if(i.id===t)return e;e++}return 0}to(t,e=!0){return(0,v._)(this,void 0,void 0,(function*(){var i,s,n=this.getAppletIndexById(t),o=this.slideView;let r=0,l=0;return"x"===this.options.slideViewSnapType?(s=(i=o.offsetWidth)*this.slideViewApplets.length,r=Math.min(Math.max(n*i,0),s)):(s=(i=o.offsetHeight)*this.slideViewApplets.length,l=Math.min(Math.max(n*i,0),s)),this.index!==n&&(yield this.freeze(this.index)),!1===e?(o.style.scrollBehavior="auto",o.scrollLeft=r,o.scrollTop=l,o.style.scrollBehavior="smooth",Promise.resolve()):(this.switching=!0,this.openOverlay(),this.application.activate(!1),this.scroller.snapTo(r,l).then((()=>{this.closeOverlay(),this.switching=!1,this.activate(this.index),this.application.activate(!0)})))}))}destroy(t){return(0,v._)(this,void 0,void 0,(function*(){var e=this.getAppletIdByIndex(t);return(e=e&&this.application.applets[e])?!1!==e.config.background?Promise.resolve(!1):e.destroy(!0):Promise.resolve(!0)}))}freeze(t){return(0,v._)(this,void 0,void 0,(function*(){var e=this.getAppletIdByIndex(t);return e?this.application.get(e).then((t=>{t.hide(),this.applet.trigger("slideOut",t)})):Promise.resolve()}))}activate(t){return(0,v._)(this,void 0,void 0,(function*(){const e=this.getAppletIdByIndex(t);return e?this.application.get(e).then((t=>(0,v._)(this,void 0,void 0,(function*(){return t.show(),this.applet.trigger("slideEnter",t),e!==this.activeId&&this.destroy(this.getAppletIndexById(this.activeId)),this.activeId=e,t.view&&t.visibility?Promise.resolve():t.build()})))):Promise.resolve()}))}freezeAll(){var t=this.slideViewApplets.length;for(let e=0;e<=t;e++)this.freeze(e)}resetViewportStyle(t){t.style.cssText=`\n      display: flex;\n      ${P}\n      scroll-snap-align: start;\n      scroll-snap-stop: always;\n      transform: translate3d(0, 0, 0);\n    `}createSlideView(t,e){const i=document.createElement("slideView-viewport");var s=document.createElement("style");const n=document.createElement("slideView-holder");var r=document.createElement("slideView-overlay"),l=this.snapType,a=this.options.slideViewGridRepeat;s.innerHTML="\n      slideView-viewport::-webkit-scrollbar {\n        display: none;\n      }\n      slideView-viewport::scrollbar {\n        display: none;\n      }\n    ",i.style.cssText=`\n      ${"y"===l?"overflow-y: auto; overflow-x: hidden;":"x"===l?"display: flex; overflow-x: auto; overflow-y: hidden;":`\n        display: grid;\n        overflow: auto;\n        grid-template-columns: repeat(${a}, 100%);\n        grid-template-rows: repeat(${a}, 100%);\n      `}\n      position: absolute;\n      ${E}\n      scroll-behavior: ${this.hasSmoothSnapScrolling?"smooth":"auto"};\n      scroll-snap-type: ${l} mandatory;\n    `,!1===(0,v.b)()&&(i.style.cssText+="-webkit-overflow-scrolling: touch;"),n.style.cssText="\n      position: absolute;\n      top: 15%;\n      bottom: 15%;\n      left: 0;\n      width: 15px;\n      z-index: 5;\n    ",r.style.cssText=`\n      position: fixed;\n      ${E}\n      z-index: 7;\n      display: none;\n    `,r.addEventListener("touchstart",(t=>{t.stopPropagation(),t.preventDefault()}),!0),r.addEventListener("touchend",(()=>{this.closeOverlay()}),!0),t.forEach(((t,e)=>{const{id:s,activate:r}=t,l=document.createElement("applet-viewport");l.id="applet-viewport-"+s,this.resetViewportStyle(l),0===e&&(this.activeId=s,this.options.openSlideViewLeftHolder&&l.appendChild(n)),i.appendChild(l),this.application.get(s).then((t=>{t.attach(l,this.applet,{agentSegue:()=>(0,v._)(this,void 0,void 0,(function*(){return this.application.to(this.applet.id).then((()=>{var t;null!=(t=this.applet.slide)&&t.to(s)}))})),noSwipeModel:!0}),"instant"===r||0===e?(t.build(),0===e&&t.show()):"lazy"===r&&o((()=>{t.build()}),{timeout:3e3})}))})),e.appendChild(s),e.appendChild(i),e.appendChild(r),this.slideView=i,this.slideViewHolder=n,this.slideViewOverlay=r}}const _=`\n  applet-viewport {\n    background: transparent !important;\n  }\n  modality-container {\n    display: flex;\n    height: 100%;\n    overflow-y: scroll !important;\n    scroll-behavior: smooth;\n    scroll-snap-type: y mandatory;\n    flex-direction: column;\n  }\n  modality-container::-webkit-scrollbar {\n    display: none;\n  }\n  modality-container::scrollbar {\n    display: none;\n  }\n  modality-placeholder {\n    position: relative;\n    display: block;\n    ${P}\n    scroll-snap-align: start;\n    scroll-snap-stop: always;\n    box-sizing: content-box;\n  }\n  modality-handle {\n    display: block;\n    position: absolute;\n    top: 100%;\n    height: 20px;\n    width: 100%;\n    z-index: 2;\n  }\n  modality-handle::before {\n    content: ' ';\n    display: block;\n    width: 36px;\n    height: 5px;\n    margin: 5px auto;\n    border-radius: 5px;\n    background: #777;\n    opacity: .5;\n  }\n  modality-handle:hover::before {\n    opacity: 1;\n  }\n  blocked-holder {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 40px;\n    height: 100%;\n    z-index: 5;\n    overflow-y: hidden;\n    overflow-x: scroll;\n    overscroll-behavior-y: none;\n    display: flex;\n    flex-flow: row-reverse;\n  }\n  blocked-holder::-webkit-scrollbar {\n    display: none;\n  }\n  blocked-holder::scrollbar {\n    display: none;\n  }\n  blocked-holder::before {\n    content: ' ';\n    display: flex;\n    min-width: 100vw;\n    height: 100%;\n  }\n`,O=!1===m(),M=!1===(0,v.b)();class B{constructor(t){this.switching=!1,this.scrollCancelTimeoutId=-1,this.advanceDegree=.03,this.applet=t,this.application=this.applet.application,this.appletViewport=this.applet.viewport,this.modalityContainer=document.createElement("modality-container"),this.scroller=new L(this.modalityContainer),this.options=this.applet.config.sheetsBottomOptions,this.buildModalityOverlay(),null!=(t=t.viewport)&&t.appendChild(this.modalityContainer)}get viewports(){return this.fromViewports||(this.fromViewports=this.application.segue.viewports)}get maxDegree(){var t;return 1+(null!=(t=null==(t=this.miniCard)?void 0:t.offsetHeight)?t:0)/this.modalityContainer.offsetHeight}get degree(){return this.modalityContainer.scrollTop/this.modalityContainer.offsetHeight}get visibility(){return!(this.degree<=.1)}switchSheets(){return(0,v._)(this,void 0,void 0,(function*(){return this.application.activityApplet!==this.applet?Promise.resolve():this.degree<=.5?this.hide():this.show()}))}switchOverlay(t=!1){this.modalityOverlay.style.display=t?"block":"none"}switchSmooth(t=!0){this.modalityContainer.style.scrollBehavior=t?"smooth":"auto"}switchSnap(t=!0){this.modalityContainer.style.scrollSnapType=t?"y mandatory":"none"}show(){return(0,v._)(this,void 0,void 0,(function*(){if(this.switching)return this.processPromise;this.switching=!0,this.switchOverlay(!0);var t=this.contentContainer.offsetHeight;return this.processPromise=this.scroller.snapTo(0,t).then((()=>{this.switching=!1,this.switchOverlay(!1)}))}))}hide(){return(0,v._)(this,void 0,void 0,(function*(){return this.switching?this.processPromise:(this.switching=!0,this.switchOverlay(!0),this.processPromise=this.scroller.snapTo(0,0).then((()=>(0,v._)(this,void 0,void 0,(function*(){this.switching=!1,this.switchOverlay(!1),this.application.activityApplet===this.applet&&(yield this.application.segue.back(),this.fromViewports=void 0)})))))}))}bindDragContent(){var t=this.applet.contentDocument;if(t){const e={x:0,y:0,top:0,swipe:void 0},i=this.modalityContainer,s=i.offsetWidth/i.offsetHeight;t.addEventListener("touchstart",(t=>{t=(t=t.changedTouches)[0],e.x=t.pageX,e.y=t.pageY,e.top=i.scrollTop,e.swipe=void 0}),!0),t.addEventListener("touchend",(()=>{e.swipe&&(i.style.scrollBehavior="smooth",this.switchSheets().then((()=>{this.switchOverlay(!1),this.switchSmooth(!0),this.switchSnap(!0),this.switching=!1})))}),!0),t.addEventListener("touchmove",(t=>{var n=(t=(t=t.changedTouches)[0]).pageX-e.x;t=t.pageY-e.y,this.switching||(e.swipe&&(i.scrollTop=e.top-n/s),void 0===e.swipe&&(10<Math.abs(n)-Math.abs(t)&&Math.abs(t)<=10?(e.swipe=!0,this.switchOverlay(!0),this.switchSmooth(!1),this.switchSnap(!1)):Math.abs(n)<Math.abs(t)&&(e.swipe=!1)))}),!0)}}bindBlockedHolder(t){let e=0,i=!1,n=!1;const o=this.modalityContainer,r=o.offsetWidth/o.offsetHeight,l=()=>{this.switchSheets().then((()=>{this.switchOverlay(!1),this.switchSmooth(!0),this.switchSnap(!0),n=!0,i=!1,t.scrollLeft=0,this.switching=!1}))};t.addEventListener("scroll",(()=>{this.switching||(n?n=!1:(this.switchOverlay(!0),this.switchSmooth(!1),this.switchSnap(!1),!1===i&&(e=o.scrollTop,i=!0),o.scrollTop=e+t.scrollLeft/r,clearTimeout(this.scrollCancelTimeoutId),this.scrollCancelTimeoutId=s((()=>{l()}),100)))}))}buildModalityOverlay(){var t=document.createElement("modality-overlay");t.style.cssText=`\n      position: fixed;\n      ${E}\n      z-index: 9;\n      display: none;\n    `,t.addEventListener("touchstart",(t=>{t.stopPropagation(),t.preventDefault()}),!1),this.modalityOverlay=t}create(){var t=this.appletViewport;const e=this.viewports[1],i=this.modalityContainer;var n=i.firstChild,o=document.createElement("modality-placeholder"),l=document.createElement("modality-handle"),a=document.createElement("blocked-holder"),h=document.createElement("applet-container"),c=document.createElement("style"),p=this.options,d=!(null==p||!p.miniCardHeight||M),u="string"==typeof(null==p?void 0:p.miniCardHeight)?null==p?void 0:p.miniCardHeight:(null!=(u=null==p?void 0:p.miniCardHeight)?u:0)+"px",v=(null==p?void 0:p.blockedHolderWidth)||"40px",m=(null==p?void 0:p.top)||"60px";const w=(null==p?void 0:p.maskOpacity)||.3;var g=null==p?void 0:p.maskClosable,f=null==p?void 0:p.noHandlebar;c.innerHTML=_,h.style.cssText=`\n      position: relative;\n      border: 0px;\n      outline: 0px;\n      min-width: 100%;\n      min-height: calc(100% - ${m});\n      max-height: calc(100% - ${m});\n      border-top-left-radius: 16px;\n      border-top-right-radius: 16px;\n      scroll-snap-align: start;\n      scroll-snap-stop: always;\n      overflow: hidden;\n    `,t.appendChild(c),t.appendChild(a),t.appendChild(this.modalityOverlay),o.appendChild(l),a.style.width="string"==typeof v?v:v+"px",n?i.insertBefore(o,n):i.appendChild(o),M&&(i.style.cssText+="-webkit-overflow-scrolling: touch;"),d&&((m=document.createElement("modality-mini-card")).style.cssText=`\n        width: 100%;\n        min-height: calc(100% - ${u});\n        scroll-snap-align: start;\n        scroll-snap-stop: always;\n      `,i.appendChild(m),l.style.top=`calc(200% - ${u})`,this.miniCard=m),g&&(o.addEventListener("click",(()=>{this.hide()})),null!=(c=this.miniCard)&&c.addEventListener("click",(()=>{this.hide()}))),f&&(l.style.display="none");const y=this.maxDegree;return this.bindBlockedHolder(a),s((()=>{this.bindDragContent()}),10),i.addEventListener("scroll",(()=>{const t=this.degree;r((()=>{t>y?i.style.background=`rgba(0, 0, 0, ${w+3*(t-1)})`:(i.style.background=`rgba(0, 0, 0, ${w*t})`,e&&!this.applet.transforming&&this.application.activityApplet===this.applet&&(e.style.transform=`scale(${1-Math.max(.03*t,0)})`))})),this.switching||(t<=this.advanceDegree&&this.hide(),O&&s((()=>{this.degree===t&&(t<=.7?this.hide():this.show())}),200))}),!1),!1!==(null==p?void 0:p.alwaysPopUp)&&(this.applet.on("willShow",(()=>{this.show()})),this.applet.on("willHide",(()=>{this.hide()}))),i.appendChild(h),this.contentContainer=h}}a=(t,e)=>{const i=t.open;t.document.addEventListener("click",(t=>{const s=(t=t instanceof CustomEvent&&t.detail instanceof Event?t.detail:t).path||(null==(n=t.composedPath)?void 0:n.call(t))||[];s.splice(-3);var n=(()=>{for(const i of s){var t=null==(t=i.getAttribute)?void 0:t.call(i,"to-applet");if(t){const s=i.getAttribute("clone-as")||void 0,[n,o]=t.split("?");if(s){const t=i.getAttribute("title")||"",r=i.getAttribute("preset-effect")||void 0;return void e.get(n).then((i=>{i=i.model,Object.assign(i.config,{title:t,animation:r,level:e.activityLevel}),e.add(s,i),e.to(s,"?"+o)}))}return void e.to(n,"?"+o)}if("A"===i.tagName)return i}})();if(n){const s=n.href||String(n);if(s){if("_parent"===n.target||"_top"===n.target)return i(s),!1;var o=n.getAttribute("title")||"",r=n.getAttribute("preset-effect")||void 0;n=n.getAttribute("clone-as")||void 0,t.stopPropagation(),t.preventDefault(),e.pushWindow(s,o,r,n,t).catch((()=>{i(s)}))}}return!1}),!0),t.open=(t,s,n)=>"string"!=typeof t||s&&0!==s.indexOf("_")||n?i(t,s,n):(e.pushWindow(t,"").catch((()=>{i(t)})),null)};const D=(t,e,i)=>(...s)=>{const n=()=>{"function"==typeof t?t(...s):"string"==typeof t&&new e.Function("return "+t)(...s)};e===window?"frozen"!==window.applicationActiveState?n():i&&window.addEventListener("message",(t=>{"application-active"===(null==(t=t.data)?void 0:t.type)&&n()})):"visible"===e.appletVisibilityState?n():i&&e.addEventListener("message",(t=>{"applet-show"===(null==(t=t.data)?void 0:t.type)&&n()}))},R=t=>{const e=t.setTimeout;t.setBackgroundTimeout=e,t.setTimeout=(i,s,...n)=>(i=D(i,t,!0),e(i,s,...n)),t.setTimeout.toString=()=>"setTimeout() { [native code] }"},N=t=>{const e=t.setInterval;t.setBackgroundInterval=e,t.setInterval=(i,s,...n)=>(i=D(i,t),e(i,s,...n)),t.setInterval.toString=()=>"setInterval() { [native code] }"};h=(t,e)=>{const i={element:null,oldStyle:""},n=()=>{var t;i.element&&(null!=(t=null==(t=i.element)?void 0:t.style)&&t.filter&&(i.element.style.filter=i.oldStyle),i.element=null,i.oldStyle="")};t.document.addEventListener("touchstart",(t=>{const o=e?"string"==typeof e?e.split(" "):e:null,r=t.path||t.composedPath()||[],l=(r.splice(-3),(()=>{var e,i;for(const t of r){if("A"===t.tagName)return t;if(null!=(e=t.children)&&e.length&&o){for(const e of o){if(0===e.indexOf("#")&&"#"+t.id===e)return t;if(0===e.indexOf(".")&&t.classList.length&&Object.values(t.classList).includes(e.slice(1)))return t;if(null!=(i=t.getAttribute)&&i.call(t,e))return t}return null}}var s=(null!=(s=null==(s=r[0])?void 0:s.children)&&s.length?r[0]:r[1])||t.target;return["DIV","A","IMG"].includes(s.tagName)?s:null})());if(l){if(i.element===l)return n();i.element=l,i.oldStyle=l.style.filter,s((()=>{if(i.element===l){if(9e4<l.offsetWidth*l.offsetHeight)return;l.style.filter=i.oldStyle+" brightness(.8)",l.setAttribute("tap-highlight","true")}const t=()=>{s((()=>{i.element!==l?(l.style.filter=i.oldStyle,l.removeAttribute("tap-highlight")):t()}),600)};t()}),60)}})),t.document.addEventListener("touchmove",n),t.document.addEventListener("touchcancel",n),t.document.addEventListener("touchend",(()=>{s((()=>{n()}),600)}))},c=(t,e)=>{var{id:i,application:s}=e,n="function"==typeof(n=s.config.globalCSSVariables)?n():n;const o=t.document.documentElement.style,r=t=>{e.snapshot=null;for(const e in t)o.setProperty(e,t[e])},l=t=>{var e;r({"--application-safe-area-top":null!=(e=t[0])?e:t,"--application-safe-area-right":null!=(e=t[1])?e:t,"--application-safe-area-bottom":null!=(e=null!=(e=t[2])?e:t[0])?e:t,"--application-safe-area-left":null!=(e=null!=(e=t[3])?e:t[1])?e:t})};(t="function"==typeof(t=s.config.safeArea)?t():t)&&l(t),n&&r(n),s.on("safeAreaChange",(t=>{l(t)}),i),s.on("globalCSSVariablesChange",(t=>{r(t)}),i)},p=(t,e)=>{var i,{config:s,application:n}=e,o=s.apply||[],r=s.applyOptions||{};if(Array.isArray(o))for(const e of o)switch(e){case"link-new-viewport":a(t,n);break;case"tap-highlight":h(t,null!=(i=null==(i=r[e])?void 0:i.selector)?i:"use-tap-highlight");break;case"smart-setTimeout":R(t);break;case"smart-setInterval":N(t)}if("function"==typeof s.inject)try{s.inject(t,e)}catch(t){console.error("config > inject:",t)}if(e.components)for(const i of e.components)t.customElements.define("code-highlight",i(t));c(t,e)};class z extends T{setShadowView(t,e){["frameworks","system"].includes(this.rel)?(t.style.cssText="\n        position: fixed;\n        width: 100%;\n        z-index: 7;\n        pointer-events: none;\n      ",e.style.pointerEvents="all"):t.style.cssText=e.style.cssText="\n        min-width: 100%;\n        min-height: 100%;\n      "}createControlsView(){var t;return this.controls=new I(this.self),null==(t=this.controls)?void 0:t.create()}getContentContainer(){return"system"===this.rel?this.viewport:this.isModality?this.createModality():this.useControls?this.createControlsView():this.viewport}buildSlideView(){return new Promise(((t,e)=>{var i;return this.slide?t():this.config.defaultSlideViewApplets?(i={openSlideViewLeftHolder:null==(i=this.config.openSlideViewLeftHolder)||i,slideViewSnapType:null!=(i=this.config.slideViewSnapType)?i:"x"},this.slide=new H(this.self,i),void t()):e()}))}buildContentImage(){var t,e,i;this.img||(e=this.viewport,i=document.createElement("applet-img"),!1===this.noShadowDom&&null!=(t=i.attachShadow)&&t.call(i,{mode:"open"}),e.appendChild(i),i.style.cssText=`\n      position: absolute;\n      ${E}\n      z-index: 2;\n      pointer-events: none;\n      background: ${this.color};\n      opacity: 1;\n      transition: opacity .3s;\n    `,this.img=i)}getPresetView(){var t;return null==(t=this.application.presetAppletsView)?void 0:t[this.id]}createContentView(){var t=document.createElement("define-applet");return this.application.defineApplet(t,this.id),t}getContentView(){var t=null!=(t=this.getPresetView())?t:this.createContentView();return"applet"===this.rel&&(t.style.cssText=`\n        position: relative;\n        z-index: 1;\n        display: flex;\n        ${P}\n        overflow: auto;\n        background: ${this.color}\n      `),t}buildContentStructure(){this.contentView||(this.contentView=this.getContentView(),this.contentSlot=this.contentView.getViewSlot(),this.getContentContainer().appendChild(this.contentSlot))}createShadowView(){var t,e,i,s;return this.config.render?(i=document.createElement("applet-shadow"),s=document.createElement("applet-shadow-inner"),!1===this.noShadowDom&&null!=(t=i.attachShadow)&&t.call(i,{mode:"open"}),(i.shadowRoot||i).appendChild(s),null!=(e=(t=this.config).render)&&e.call(t,s),null!=(e=this.contentView)&&e.appendChild(i),this.setShadowView(i,s),Promise.resolve(i)):Promise.resolve(this.contentView)}createSandbox(t,e){return(0,v._)(this,void 0,void 0,(function*(){return this.sandbox=new S(t,null==e?void 0:e.join(" ")),this.decorateSandbox(this.sandbox.sandbox),yield this.loadContentView(),this.sandbox.sandbox}))}createPortal(t){return(0,v._)(this,void 0,void 0,(function*(){var e=document.createElement("portal");return e.src=t,this.decorateSandbox(e),yield this.loadContentView(),e}))}createModality(){return this.modality=new B(this.self),this.modality.create()}loadContentView(){return(0,v._)(this,void 0,void 0,(function*(){this.waitingForResponse().then((()=>{Promise.resolve()})).catch((()=>{Promise.reject()})),this.status.refreshing?s((()=>{Promise.resolve()}),2e3):Promise.resolve()}))}loadSourceContent(){return(0,v._)(this,void 0,void 0,(function*(){var t=this.contentView;return"portal"===this.viewType?(null!=t&&t.appendChild(this.view),Promise.resolve()):this.sandbox?(this.uri?(this.sandbox.onload=()=>Promise.resolve(),this.sandbox.onerror=()=>Promise.reject(),this.sandbox.enter(t)):(this.sandbox.append(yield this.source,t),this.sandbox.onunload=this.loadSourceContent.bind(this),Promise.resolve()),void this.injectIntoContentWindow()):Promise.resolve()}))}injectIntoContentWindow(){var t;!this.sameOrigin||(t=this.contentWindow).__LATH_APPLICATION_AVAILABILITY__||(p(t,this),t.__LATH_APPLICATION_AVAILABILITY__=!0)}loadMirrorImage(){this.status.refreshing||this.config.useMirroring&&!this.img&&(this.buildContentImage(),this.setImageContent(this.mirroringString||""))}setImageContent(t){var e=(e=this.img).shadowRoot||e;"string"==typeof t?e.innerHTML=t:e.appendChild(t)}removeMirrorImage(){if(this.img&&!this.status.refreshing){const t=this.img;s((()=>{var e;t.style.opacity="0",null!=(e=t.parentNode)&&e.removeChild(t),this.img=null}),300)}}decorateSandbox(t){t.style.cssText=`\n      ${P}\n      border: 0;\n      outline: 0;\n    `}waitingForResponse(){return new Promise(((t,e)=>{this.loadSourceContent().then((()=>{var e;this.status.prerender=!0,null!=(e=this.events)&&e.load(this.self),this.trigger("load"),this.attachEvent(),s((()=>{t()}),0)})).catch((()=>{var t;null!=(t=this.events)&&t.loadError(this.self),this.trigger("loadError"),e()}))}))}createView(){return"shadow"===this.viewType?this.createShadowView():"portal"===this.viewType?this.createPortal(this.uri):this.createSandbox(this.uri,this.config.sandbox)}buildMainView(){return(0,v._)(this,void 0,void 0,(function*(){return this.cancelGuard(),this.expired?this.refresh():(this.view||(this.createTime=Date.now(),this.loadMirrorImage(),this.buildContentStructure(),this.injectIntoContentWindow(),this.view=yield this.createView(),this.removeMirrorImage()),Promise.resolve())}))}build(){return(0,v._)(this,void 0,void 0,(function*(){if(this.config.defaultSlideViewApplets){if("frameworks"!==this.id)return this.buildSlideView();this.buildSlideView()}return yield this.buildMainView(),Promise.resolve()}))}refresh(){var t;return(0,v._)(this,void 0,void 0,(function*(){if(this.status.refreshing||!this.view)return Promise.reject();var e,i,s;this.status.refreshing=!0,this.config.refresh instanceof Promise?(yield this.config.refresh(),this.status.refreshing=!1,this.trigger("refreshing")):"applet"!==this.rel&&this.noSource?this.status.refreshing=!0:(e=this.contentView,i=this.contentSlot,s=this.view,e.setAttribute("applet-id",this.id+"-obsolete"),i.name=`applet-${this.id}-obsolete`,this.application.delPresetAppletsView(this.id),this.contentView=void 0,"applet"===this.rel&&this.noSource&&(this.config.source={src:location.href}),this.contentView=this.getContentView(),this.view=yield this.createView(),i.name="applet-"+this.id,this.status.refreshing=!1,this.trigger("refreshing"),"IFRAME"===s.tagName&&this.unload(s),null!=(t=s.parentNode)&&t.removeChild(s),null!=(t=e.parentElement)&&t.removeChild(e))}))}captureShot(t=!0){return(0,v._)(this,void 0,void 0,(function*(){return!t&&this.snapshot&&this.snapshotTime===this.createTime?this.snapshot:(this.snapshotTime=this.createTime,Promise.all([i.e(730),i.e(942)]).then(i.bind(i,942)).then((t=>(0,v._)(this,void 0,void 0,(function*(){return t.capture(this.self).then((t=>this.snapshot=t))})))))}))}}class $ extends z{constructor(t,e,i){super(t,e,i),this.events.boot(this.self)}}class j extends class extends class extends class extends class extends class{constructor(t,e){this.id="",this.prevId="",this.param="",this.relativeViewport=document.createElement("relative-windows"),this.absoluteViewport=document.createElement("absolute-windows"),this.fixedViewport=document.createElement("fixed-windows"),this.applicationViewport=document.createElement("application-windows"),this.target=this.relativeViewport,this.application=t,this.root=e.root||document.body,this.zIndex=e.zIndex||Number.MAX_SAFE_INTEGER,this.setupViewport()}setupViewport(){this.relativeViewport.id="relative-viewport",this.absoluteViewport.id="absolute-viewport",this.resetViewport(),this.fixedViewport.id="fixed-viewport",this.fixedViewport.style.cssText="\n      width: 100%;\n      height: 0;\n      max-height: 0;\n      overflow: visible;\n      contain: strict;\n      z-index: 3;\n      overflow: hidden;\n    ",this.applicationViewport.style.cssText=`\n      position: fixed;\n      ${E}\n      overflow: hidden;\n      contain: strict;\n      z-index: ${this.zIndex};\n    `,this.applicationViewport.appendChild(this.relativeViewport),this.applicationViewport.appendChild(this.absoluteViewport),this.applicationViewport.appendChild(this.fixedViewport),this.root.appendChild(this.applicationViewport)}resetViewport(t){var e=`\n      position: fixed;\n      ${E}\n      overflow: hidden;\n      contain: strict;\n    `;this.relativeViewport.style.cssText=`\n      ${e}\n      z-index: 1;\n      ${t?"transform: translate3d(0, 0, 0);":""}\n    `,this.absoluteViewport.style.cssText=`\n      ${e}\n      z-index: 2;\n      ${t?"":"transform: translate(200%, 200%);"}\n    `}}{constructor(t,e){super(t,e),this.prevHistoryStep=0,this.historyIndex=history.length,this.historyShadowLength=history.length,this.oneHistoryIndex=0,this.historyDirection=0,this.backoutCount=0,this.sessionHistory=[],this.silentObserver=void 0,this.defaultURLPath=location.pathname,this.defaultURLSearch=location.search,this.historyBreakCallback=null,this.bindHistoryState()}get fromHistoryForward(){return-1===this.prevHistoryStep&&1===this.historyDirection}get fromHistoryBack(){return-1===this.prevHistoryStep&&-1===this.historyDirection}get historyState(){return"loading"===document.readyState?this.sessionHistory[this.oneHistoryIndex]:history.state}get isOverscrollHistoryNavigation(){var t,e;return!(!this.fromHistoryBack&&!this.fromHistoryForward||(e=-1!==(t=this.application.overscrollHistoryNavigation).type.indexOf("wipe")?300:200,Date.now()-t.moment>e))}bindHistoryState(){addEventListener("popstate",(t=>{this.popstate(t.state)}),!1),addEventListener("hashchange",(()=>{this.observeSilent()}),!1)}observeSilent(t=1e3){if(!this.options.oneHistory){"loading"===document.readyState&&(t=3e4),clearInterval(this.silentObserver);let e=0;this.silentObserver=n((()=>(0,v._)(this,void 0,void 0,(function*(){++e>=t&&clearInterval(this.silentObserver);var i=this.historyState||history.state||this.application.route;(i=decodeURIComponent(i.id))&&decodeURIComponent(i)!==this.id&&(yield this.popstate(this.historyState).catch((()=>{clearInterval(this.silentObserver)})))}))),500)}}popstate(t){return(0,v._)(this,void 0,void 0,(function*(){var{historyIndex:e=this.historyShadowLength}=null!=t?t:{};e===this.historyIndex?this.historyDirection=0:e>this.historyIndex?this.historyDirection=1:this.historyDirection=-1,null===t?(this.historyDirection=-1,this.historyIndex=this.historyIndex-1):this.historyIndex=e,yield this.toHistory(t),this.observeSilent(20)}))}back(t){return(0,v._)(this,void 0,void 0,(function*(){return this.backFromType=t,this.backTo().catch((()=>{this.backFromType=void 0}))}))}backTo(){var t;return this.options.oneHistory?(t=this.sessionHistory[this.oneHistoryIndex-1])?(this.historyDirection=-1,this.oneHistoryIndex=this.oneHistoryIndex-1,this.toHistory(t)):Promise.reject():(history.back(),this.observeSilent(20),Promise.resolve())}forward(){var t;return this.options.oneHistory?(t=this.sessionHistory[this.oneHistoryIndex+1])?(this.historyDirection=1,this.oneHistoryIndex=this.oneHistoryIndex+1,this.toHistory(t)):Promise.reject():(history.forward(),this.observeSilent(20),Promise.resolve())}getSearch(t=""){return(t=new URL(t,location.origin+this.defaultURLPath+this.defaultURLSearch)).pathname+t.search}pushState(t="",e="",i=""){t=encodeURIComponent(t),i=this.getSearch(i);var s=this.historyShadowLength,n={id:t,title:e,time:Date.now(),search:i,historyIndex:s};if(this.observeSilent(20),0!==this.sessionHistory.length&&(this.sessionHistory.length=this.oneHistoryIndex+1),this.sessionHistory.push(n),this.oneHistoryIndex=this.sessionHistory.length-1,this.options.oneHistory)return this.replaceState(t,e,i);history.pushState(n,e,i+"#"+t),this.historyIndex=this.historyShadowLength=s+1,this.historyDirection=1}replaceState(t="",e="",i=""){t=encodeURIComponent(t),i=this.getSearch(i);var s=this.historyShadowLength,n={id:t,title:e,time:Date.now(),search:i,historyIndex:s};history.replaceState(n,e,i+"#"+t),this.historyIndex=s,this.historyDirection=0}requestRegisterHistory(t="",e="",i=""){if("portal"!==this.applet.viewType){if(this.options.oneHistory,-1===this.prevHistoryStep)return this.replaceState(t,e,i);this.pushState(t,e,i)}}toHistory(t){var e,i;return(0,v._)(this,void 0,void 0,(function*(){var s,n,o=this.options,r=t||history.state||this.application.route,l=decodeURIComponent(r.id)||o.index||"frameworks",a=(r=r.search,yield this.application.get(l));if(a){if(!this.checkSingleLock())return this.backoutCount=0,s=null!=(i=a.config.level)?i:0,n=null!=(i=this.applet.config.level)?i:0,o.singleFlow&&0!==s&&n<=s?this.back():(this.isOverscrollHistoryNavigation&&null!=(i=this.historyBreakCallback)&&i.call(this),this.application.segue.to(l,r,-1).then((()=>{this.backFromType=void 0})),this.application.trigger("back",a),Promise.resolve());this.backoutCount++,!0===(null==(e=(i=this.options).holdBack)?void 0:e.call(i,this.backoutCount))&&(this.pushState(l,a.config.title,r),this.application.trigger("exit",{backoutCount:this.backoutCount}))}}))}checkSingleLock(){return!(!this.options.singleLock||0!==this.applet.config.level||-1!==this.historyDirection)}bindHistoryBreak(t){this.historyBreakCallback=t}}{constructor(){super(...arguments),this.hasAnimation=!1,this.hasSuperSwitched=!1,this.isNativeAnimation=!1,this.viewportLevelLength=2,this.historyIndexOfStartOverlaying=void 0}get isEntryApplet(){return!this.prevApplet||"applet"!==this.prevApplet.rel}get immovable(){return this.hasSuperSwitched||!this.hasAnimation||this.countercurrent}get fallbackState(){var t;return 1===this.appletGroup.length?-1:!this.applet.config.free&&null!=(t=this.prevApplet)&&t.config.free||!(this.applet.config.free&&(null==(t=this.prevApplet)||!t.config.free)||this.applet.viewLevel>=(null!=(t=null==(t=this.prevApplet)?void 0:t.viewLevel)?t:0))?1:0}get countercurrent(){return 1===this.fallbackState||this.fromHistoryBack}get viewports(){var t;return this.hasSuperSwitched?[this.applet.config.free?this.absoluteViewport:this.relativeViewport,null!=(t=this.prevApplet)&&t.config.free?this.absoluteViewport:this.relativeViewport]:[this.applet.viewport,null==(t=this.prevApplet)?void 0:t.viewport]}get isSheetLayer(){return!this.prevApplet||"frameworks"===this.prevApplet.rel&&!this.prevApplet.slide}get noOverlay(){return void 0===this.historyIndexOfStartOverlaying?!!this.isSheetLayer||(this.historyIndexOfStartOverlaying=this.historyIndex,!1):this.historyIndex<=this.historyIndexOfStartOverlaying}}{checkAnimationNamed(){return!!this.getAnimationNames()}checkNativeAnimation(){var t=this.getAnimationNames();return"string"==typeof t&&["slide","slide-left","sheets-bottom"].includes(t)}getAnimationNames(){var t;return!(this.options.index&&this.applet.isFullscreen&&this.isEntryApplet)&&!this.isOverscrollHistoryNavigation&&"controls"!==this.backFromType&&(!0===(t=null!=(t=null==(t=this[this.countercurrent?"prevApplet":"applet"])?void 0:t.config.animation)?t:"slide")||"inherit"===t?this.options.defaultAnimation:t)}getAnimationGroup(){return(0,v._)(this,void 0,void 0,(function*(){let t;var e=this.getAnimationNames();if("string"==typeof e)t=yield this.getAnimationByName(e);else if("function"==typeof(null==e?void 0:e[0]))return e;if("function"==typeof(null==t?void 0:t[0]))return t}))}getAnimationOneSide(t){return(0,v._)(this,void 0,void 0,(function*(){var e=yield this.getAnimationGroup();if(0<=t)switch(typeof e){case"function":return e;case"object":return e[2===e.length?t:0];default:return}}))}getAnimationByName(t){return(0,v._)(this,void 0,void 0,(function*(){switch(t){case"sheets-bottom":return new Promise(((t,e)=>{i.e(832).then(i.bind(i,832)).then((e=>{e=e.default,t([e,e])})).catch(e)}));case"flip":return new Promise(((t,e)=>{i.e(867).then(i.bind(i,2)).then((e=>{e=e.default,t([e(4),e(4)])})).catch(e)}));case"flip-left":return new Promise(((t,e)=>{i.e(867).then(i.bind(i,2)).then((e=>{e=e.default,t([e(3),e(3)])})).catch(e)}));case"flip-down":return new Promise(((t,e)=>{i.e(867).then(i.bind(i,2)).then((e=>{e=e.default,t([e(2),e(2)])})).catch(e)}));case"flip-right":return new Promise(((t,e)=>{i.e(867).then(i.bind(i,2)).then((e=>{e=e.default,t([e(1),e(1)])})).catch(e)}));case"flip-up":return new Promise(((t,e)=>{i.e(867).then(i.bind(i,2)).then((e=>{e=e.default,t([e(0),e(0)])})).catch(e)}));case"fade":return new Promise(((t,e)=>{i.e(759).then(i.bind(i,759)).then((e=>{e=e.default,t([e(1),e(0)])})).catch(e)}));case"zoom":return new Promise(((t,e)=>{i.e(858).then(i.bind(i,858)).then((e=>{e=e.default,t([e(1),e(0)])})).catch(e)}));case"slide-right":return new Promise(((t,e)=>{i.e(131).then(i.bind(i,131)).then((e=>{e=e.default,t([e(3),e(1)])})).catch(e)}));case"slide-up":return new Promise(((t,e)=>{i.e(131).then(i.bind(i,131)).then((e=>{e=e.default,t([e(2),e(0)])})).catch(e)}));case"slide-down":return new Promise(((t,e)=>{i.e(131).then(i.bind(i,131)).then((e=>{e=e.default,t([e(0),e(2)])})).catch(e)}));default:return new Promise(((t,e)=>{(this.options.swipeModel?i.e(63).then(i.bind(i,63)).then((e=>{e=e.default,t([e,e])})):i.e(131).then(i.bind(i,131)).then((e=>{e=e.default,t([e(1),e(3)])}))).catch(e)}))}}))}}{constructor(t,e){super(t,e),this.windowSet=[],this.promiseQueue=[],this.promiseParamQueue=[],this.delayDynamicImport()}to(...t){return(0,v._)(this,void 0,void 0,(function*(){var e=this.next()||this.promise(...t);return this.pushPromise(this.bindPromiseDone(e),t)}))}attachAppletViewport(t){var e;t.viewport||((e=document.createElement(t.rel+"-viewport")).setAttribute("name",t.id),t.attach(e),this.getSuperViewport(t).appendChild(e))}delayDynamicImport(){o((()=>{i.e(694).then(i.bind(i,694)).catch((t=>{console.warn(t)}))}))}setStepLevel(){this.fromHistoryBack||this.applet.setLevel(1+this.viewportLevelLength++)}resetAppletViewport(t,e=this.immovable){var i=t.viewport;t=["frameworks","system"].includes(t.rel),i.style.cssText="",t||(i.style.cssText=`\n      position: absolute;\n      ${E}\n      z-index: ${this.applet.viewLevel};\n      display: block;\n      transform: ${e?"translate3d(0, 0, 0)":"translate3d(0, 200%, 0)"};\n      backface-visibility: hidden;\n      contain: strict;\n      overflow: hidden;\n    `)}getSuperViewport(t=this.applet){return"system"===t.rel?this.fixedViewport:t.config.free?this.absoluteViewport.shadowRoot||this.absoluteViewport:this.relativeViewport.shadowRoot||this.relativeViewport}checkSwitchViewport(t=this.prevApplet,e=this.applet){return!!e.config.free!=!!(t=t||e).config.free}prev(){return this.promiseQueue[0]}next(){var t=this.prev(),e=()=>this.bindPromiseDone(this.promise(...this.promiseParamQueue[0]));if(t)return t.then(e).catch(e)}pushPromise(t,e){return this.promiseParamQueue.push(e),this.promiseQueue.push(t),t}shiftPromise(){this.promiseParamQueue.shift(),this.promiseQueue.shift()}bindPromiseDone(t){return(0,v._)(this,void 0,void 0,(function*(){var e=()=>this.shiftPromise();return t.then(e).catch(e)}))}limit(t){var e=Math.max((null==(e=null==this?void 0:this.options)?void 0:e.limit)||3,2),i=this.windowSet.indexOf(t);"applet"===this.applet.rel&&!0!==this.applet.config.background&&(-1!==i&&this.windowSet.splice(i,1),this.windowSet.push(t),this.windowSet.length>e&&null!=(i=this.application.applets[this.windowSet.splice(0,1)[0]])&&i.destroy())}destroy(t){t.transient&&-1===this.prevHistoryStep?this.application.del(t.id).then((()=>{var e=this.windowSet.indexOf(t.id);this.windowSet.splice(e,1)})):t.guarding().then((e=>{e||t.destroy().then((()=>{var e=this.windowSet.indexOf(t.id);this.windowSet.splice(e,1)}))}))}getActionPosition(t){let e=0,i=0;return i=t.changedTouches?(e=t.changedTouches[0].pageX,t.changedTouches[0].pageY):(e=t.x,t.y),{x:e,y:i}}promise(t,e="",i=1,s){var n;return(0,v._)(this,void 0,void 0,(function*(){var o=this.id;const r=this.application.applets[t];var l=(o=this.application.applets[o])?[r,o]:[r];return r?t===this.id?Promise.resolve():null!=(n=r.mountBehavior)&&n.agentSegue?null==(n=r.mountBehavior)?void 0:n.agentSegue():(this.prevId=this.id,this.id=t,this.param=this.getSearch(e),this.applet=r,this.prevApplet=o,this.appletGroup=l,this.prevHistoryStep=i,this.hasAnimation=this.checkAnimationNamed(),this.isNativeAnimation=this.checkNativeAnimation(),this.hasSuperSwitched=this.checkSwitchViewport(),this.target=this.getSuperViewport(),this.touches=s?this.getActionPosition(s):r.getActionOrigin(),this.setStepLevel(),this.attachAppletViewport(r),this.resetAppletViewport(r),this.requestRegisterHistory(t,r.config.title,e),r.setActionOrigin(this.touches),yield r.setParam(this.param),yield r.build(),this.start().then((()=>(0,v._)(this,void 0,void 0,(function*(){return this.transform().then((e=>{this.end(e),this.limit(t),this.application.pullDependencies(null==(e=r.config)?void 0:e.prerender).then((()=>{this.application.trigger("prerenderComplete")})),r.config.title&&(document.title=r.config.title)}))}))))):this.application.get(t).then((()=>this.promise(t,e,i))).catch((()=>{if(this.options.notFound)return this.promise(this.options.notFound,e?e+"&__notFoundId="+t:"?__notFoundId="+t,i)}))}))}pos(){let t=(null==(n=this.touches)?void 0:n.x)||0,e=(null==(n=this.touches)?void 0:n.y)||0,i="center",s="center";var n=this.relativeViewport.offsetWidth,o=this.relativeViewport.offsetHeight;return t&&e&&(s=[t,e],t<n/4?t=0:t>3*n/4&&(t=n),e<o/4?e=0:e>3*o/4&&(e=o),i=[t,e]),{x:t,y:e,width:n,height:o,attach:i,origin:s}}modulation(t){const e=this.viewports,s=this.fallbackState,n=this.countercurrent,o=this.pos();return new Promise(((r,l)=>{i.e(694).then(i.bind(i,694)).then((({Animate:i})=>{i={x:o.x,y:o.y,in:new i(e[0]),out:new i(e[1]),view:e,width:o.width,height:o.height,viewports:[this.relativeViewport,this.absoluteViewport],applets:this.appletGroup,reverse:n,direction:n?-1:1,fallbackState:s,historyDirection:this.historyDirection,origin:o.origin,attach:o.attach,touches:this.touches,swipeTransitionType:null!=(i=this.options.swipeTransitionType)?i:"zoom",callback:t},r(i)})).catch((()=>{l()}))}))}transform(){return(0,v._)(this,void 0,void 0,(function*(){return new Promise((t=>{var e;if(!this.hasAnimation)return null!=(e=this.applet.controls)&&e.disable(),this.switchViewport(),t(!1);this.getAnimationOneSide(this.fallbackState).then((e=>{this.bindHistoryBreak((()=>t(!1))),this.modulation(t).then((i=>{var n;if(!e)return t(!1);null!=(n=this.prevApplet)&&n.willSegueHide(),this.applet.willSegueShow(),r((()=>{var n=e(i);n instanceof Promise&&n.then(t),s((()=>t(!1)),1700)}))})).catch((()=>{t(!1)}))})).catch((()=>t(!1)))}))}))}start(){return new Promise(((t,e)=>{this.application.activate(!1),this.application.trigger("transformStart",this.appletGroup);var i=this.applet.events.transformStart;if("function"==typeof i&&"break"===i(this.applet))return e();this.hasAnimation&&!this.hasSuperSwitched||this.applet.viewport&&"applet"===this.applet.rel&&(this.applet.viewport.style.transform="translate3d(0, 0, 0)",this.applet.viewport.style.display="block"),!this.applet.controls||!this.noOverlay&&this.isNativeAnimation||this.applet.controls.disable(),this.applet.willShow(),this.prevApplet&&this.prevApplet.willHide(),t()}))}end(t=!1){(this.applet.isFullscreen||this.countercurrent)&&(this.hasSuperSwitched&&this.switchViewport(),this.switchApplet(t)),this.applet.controls&&!this.noOverlay&&(this.applet.controls.enable(),this.applet.controls.activate()),this.applet.show(),this.prevApplet&&this.prevApplet.hide(),"function"==typeof(t=this.applet.events.transformEnd)&&t(this.applet),this.application.activate(!0),this.application.trigger("transformEnd",this.appletGroup)}switchViewport(){var t;this.resetViewport(null==(t=null==(t=this.applet)?void 0:t.config)?void 0:t.free)}switchApplet(t=!1){this.prevApplet&&(t||("applet"===this.prevApplet.rel&&(t=(this.options.swipeModel||this.applet.config.modality)&&!this.countercurrent||this.prevApplet.config.modality&&this.fromHistoryBack,this.prevApplet.viewport&&(this.prevApplet.viewport.style.transform=t?"translate3d(0, 0, 0)":"translate3d(0, 200%, 0)",this.prevApplet.viewport.style.display=t?"block":"none")),this.resetAppletViewport(this.applet,!0)),this.prevApplet.viewport&&(this.prevApplet.viewport.style.transitionDuration="0ms"),!1!==this.prevApplet.config.background||this.applet.config.modality?this.prevApplet.hide():this.destroy(this.prevApplet))}}{setup(t){this.options=t}}class W extends g{constructor(){super(...arguments),this.applets={},this.residentApplets=[],this.presetAppletsView={},this.historyNodeLocation=history.length,this.routerRegExp=/([^#/]+)(.+)?/}resolveURL(t){var e=t=new URL(t,window.location.toString());return void 0===t.href&&(e.href=String(t)),e}verifyAppletSrcLegitimacy(t){var e=this.config.capture;if(e)return this.captureAppletSrc(t,e);if(0===(e=this.config.allowHosts||[]).length)return!0;e.push(location.host);var i=new URL(decodeURIComponent(t),window.location.toString()).host;for(const t of e)if(i===t)return!0;return!1}captureAppletSrc(t,e=this.config.capture){var i=this.resolveURL(t),s=i.origin+i.pathname;if("string"==typeof e){if(e===s)return!0}else if("function"==typeof e&&e(i,t))return!0;return!1}promiseApplet(t){return Promise.resolve(t())}checkIsPresetAppletsView(t){return this.residentApplets.includes(t)}delPresetAppletsView(t){delete this.presetAppletsView[t]}setPrestAppletsView(t){this.residentApplets=Object.keys(t),this.presetAppletsView=t}setting(t){this.options=t}}class F extends W{constructor(){var t;super(...arguments),this.overscrollHistoryNavigation={moment:0,type:""},this.properties={darkTheme:null==(t=null==(t=window.matchMedia)?void 0:t.call(window,"(prefers-color-scheme: dark)"))?void 0:t.matches},this.activeState="active"}get route(){var t=(e=this.routerRegExp.exec(location.hash)||[])[1],e=e[2],i=location.search;return{id:t?decodeURIComponent(t):"",param:e?decodeURIComponent(e):"",search:i}}get exists(){try{return parseInt(sessionStorage.getItem(location.pathname+"__EXISTS")||"-1",10)===history.length}catch(t){return!1}}get activityApplet(){var t=this.segue.id;return this.applets[t]}get prevActivityApplet(){var t=this.segue.prevId;return this.applets[t]}get activityLevel(){var t;return(null!=(t=null==(t=this.activityApplet)?void 0:t.level)?t:0)+1}setExists(){const t=location.pathname+"__EXISTS",e=String(history.length);return new Promise(((i,s)=>{try{sessionStorage.setItem(t,e),i()}catch(i){try{sessionStorage.clear(),sessionStorage.setItem(t,e)}catch(i){s()}}}))}activate(t){var e="application-"+(t=t?"active":"frozen");if(window.applicationActiveState!==t){this.activeState=t,this.trigger(t),window.applicationActiveState=t,window.postMessage({type:e},"*");for(const t in this.applets){var i=this.applets[t];i.sandbox&&!i.sameOrigin&&i.triggerWindow(e)}}}}d=t=>{window.addEventListener("message",(e=>{var{action:e,data:i}=e.data;switch(e){case"to":t.segue.to(i.applet,i.query,i.history);break;case"back":t.segue.back();break;case"forward":t.segue.forward();break;case"pushWindow":t.pushWindow(...i)}}))},u=Object.freeze({__proto__:null,Application:class extends F{constructor(t={}){super(),this.tunneling=!1,this.pullRefreshHolder={holder:null,spinner:null,holdLayer:null},this.working=!1,this.root=t.root,this.appletsSpace=t.appletsSpace,this.tunneling=parent!==window&&!!t.tunneling&&parent.__LATH_APPLICATION_AVAILABILITY__,this.segue=new j(this,t),this.presetConfig=t,this.to=this.segue.to.bind(this.segue),this.activateTunneling(),d(this),this.setBaseStyle()}setBaseStyle(){var t=document.createElement("style");t.innerHTML="\n  html, body {\n    width: 100vw;\n    height: 100vh;\n    min-width: 100vw;\n    min-height: 100vh;\n    max-width: 100vw;\n    max-height: 100vh;\n    overflow: hidden;\n  }\n  define-applet {\n    display: block;\n  }\n",document.head.appendChild(t)}add(t,e){var i;return this.applets[t]||((i=null==(i=this.config)?void 0:i.appletManifestProcess)&&(e=i(e)||e),this.applets[t]=new $(t,e,this))}del(t){return new Promise(((e,i)=>{var s=this.applets[t];s.view?s.destroy().then(e).catch(i):e(!0),delete this.applets[t]}))}get(t){var e;return(0,v._)(this,void 0,void 0,(function*(){if("object"==typeof this.applets[t])return Promise.resolve(this.applets[t]);var i=this.options.applets[t];switch(typeof i){case"function":return Promise.resolve(this.add(t,yield this.promiseApplet(i)));case"object":return Promise.resolve(this.add(t,i));case"string":return this.verifyAppletSrcLegitimacy(t)&&null!=(e=yield this.createAppletByURL(t,{},t))?e:Promise.reject();default:return Promise.reject()}}))}defineApplet(t,e){t.setAttribute("applet-id",e),this.appletsSpace.appendChild(t),!0===function(){var t=(0,v.i)();return!!(t&&t[0]<=13)}()&&s((()=>{t.slot="none",s((()=>{t.slot="applet-"+e}),0)}),0)}cloneAsNewApplet(t,e,i={}){return e?(i=Object.assign({},t.model.config,i),this.add(e,Object.assign({},t.model,{config:i}))):t}getAppletByURL(t){return(0,v._)(this,void 0,void 0,(function*(){if((e=this.config.transfer)&&"string"==typeof(e=e(t)))return this.get(e);var e,i=this.applets,s=(e=this.resolveURL(t)).origin+e.pathname;for(const e in i){var n=i[e],o=n.config.capture;if("applet"===n.rel){if(o&&this.captureAppletSrc(t,o))return n;if(n.uri===s)return n}}}))}createAppletByURL(t,e,i){var s;return(0,v._)(this,void 0,void 0,(function*(){var n=decodeURIComponent(t),o=this.applets;return(o=null!=(s=o[n])?s:yield this.getAppletByURL(t))?i?this.cloneAsNewApplet(o,i,e):o:(o=!0!==this.config.disableTransient,this.add(n,{config:Object.assign({title:"",rel:"applet",free:!0,source:{src:t},background:"auto",timeout:o?0:null!=(s=this.config.transientTimeout)?s:6e4,animation:"inherit",color:this.config.color,transient:o},e)}))}))}pushWindow(t,e="",i="slide",s,n){var o;return(0,v._)(this,void 0,void 0,(function*(){var r,l;return this.verifyAppletSrcLegitimacy(t)?this.tunneling?(parent.postMessage({action:"pushWindow",data:[t,e,i,s,n]},"*"),Promise.resolve()):-1===(r=this.resolveURL(t)).protocol.indexOf("http")?Promise.reject("Unknown"):(r=r.search,(l=yield this.createAppletByURL(t,{title:e,animation:i,level:this.activityLevel},s))?this.segue.to(l.id,null!=(o=null==(o=l.config)?void 0:o.source)&&o.html?r:"",1,n):Promise.reject()):Promise.reject("Illegal")}))}pullDependencies(t=[],e=!0){var i=[];for(const s of t)i.push(new Promise(((t,i)=>{this.get(s).then((i=>{e?i.prerender().then(t).catch(t):t("")})).catch(i)})));return Promise.all(i)}updateSafeArea(t){this.trigger("safeAreaChange",t)}updateGlobalCSSVariables(t){this.trigger("globalCSSVariablesChange",t)}refresh(){for(const e in this.applets){var t=this.applets[e];t.visibility?t.refresh():t.status.requestRefresh=!0}}install(t,e,s,n){return new Promise(((o,r)=>{i.e(342).then(i.bind(i,342)).then((({install:i})=>{i(t,e,s,n).then(o).catch(r)})).catch((t=>{console.warn(t)}))}))}createAppSwitcher(){i.e(734).then(i.bind(i,734)).then((({AppSwitcher:t})=>{this.appSwitcher=new t(this)})).catch((t=>{console.warn(t)}))}createPullToRefreshHolder(){i.e(129).then(i.bind(i,129)).then((t=>{this.pullRefreshHolder=t.createPullToRefreshHolder(this.properties.darkTheme,this.segue.fixedViewport),this.trigger("pullToRefreshAvailable")})).catch((t=>{console.warn(t)}))}mountSystem(){this.options.applets.system&&this.get("system").then((t=>{this.segue.attachAppletViewport(t),t.build().then((()=>this.trigger("systemDidMount",t)))}))}mountFramework(){return(0,v._)(this,void 0,void 0,(function*(){return this.get("frameworks").then((t=>{var e=this.route;const i=t.config;var s=i.index||"",n=i.preIndex;const o=e.id||s;return this.config=i,this.segue.setup({singleFlow:i.singleFlow,singleLock:i.singleLock,index:s,defaultIndex:o,oneHistory:i.oneHistory,notFound:i.notFound||s,limit:Math.max(i.limit||7,2),defaultAnimation:i.animation,holdBack:i.holdBack,swipeTransitionType:i.swipeTransitionType,swipeModel:t.swipeModel}),Promise.all([this.segue.to("frameworks",void 0,-1).then((()=>{i.pullToRefresh&&this.createPullToRefreshHolder(),i.appSwitcher&&this.createAppSwitcher(),this.trigger("frameworksDidMount",t),window.dispatchEvent(new CustomEvent("lathApplicationReady",{detail:{application:this}}))})),this.mountFirstApplet(o,s,n,i.oneHistory).then((()=>{this.segue.id!==o&&this.resolveURL(o).origin!==location.origin&&this.pushWindow(o)}))])})).catch((()=>{(0,v.t)(1007)}))}))}createCloneApplet(t){return(0,v._)(this,void 0,void 0,(function*(){var e=t.split("^");1!==e.length&&this.get(e[1]).then((e=>{e=e.model,Object.assign(e.config,{level:this.activityLevel}),this.add(t,e)})).catch((()=>{(0,v.t)(1008,"error",t)}))}))}mountFirstApplet(t,e,i,s){return(0,v._)(this,void 0,void 0,(function*(){return yield this.createCloneApplet(t),s?(this.segue.pushState(e||"frameworks"),t?this.segue.to(t,void 0,1):Promise.resolve()):t!==e&&t!==i?(e||i||this.segue.pushState("frameworks"),i&&this.segue.pushState(i),t?this.segue.to(t,void 0,this.exists?-1:1):Promise.resolve()):t?this.segue.to(t,void 0,-1):Promise.resolve()}))}activateTunneling(){window.addEventListener("message",(t=>{var e=t.data.type,i=this.activityApplet;if(t.source!==window)switch(e){case"applet-show":null!=i&&i.show();break;case"applet-hide":null!=i&&i.hide();break;case"applet-will-show":null!=i&&i.willShow();break;case"applet-will-hide":null!=i&&i.willHide();break;case"application-active":null!=this&&this.activate(!0);break;case"application-frozen":null!=this&&this.activate(!1)}}))}start(){return(0,v._)(this,void 0,void 0,(function*(){return this.options.applets?this.working?Promise.reject("repeat"):(this.working=!0,this.setExists(),this.mountFramework().then((()=>{this.trigger("firstAppletDidMount"),this.mountSystem()}))):Promise.reject("Please configure the applet first!")}))}}})}}]);