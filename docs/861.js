"use strict";(self.webpackChunklath_docs=self.webpackChunklath_docs||[]).push([[861],{3861:(t,e,i)=>{i.r(e),i.d(e,{S:()=>O,a:()=>d,b:()=>u,i:()=>m,r:()=>n,s:()=>o});var s,o,n,r,l,a,h,p,c,d,u,v,m,g=i(3647);function f(){return!(!("scrollSnapAlign"in document.documentElement.style||"webkitScrollSnapAlign"in document.documentElement.style||"msScrollSnapAlign"in document.documentElement.style)||!(0,g.a)())}function w(){var t=(0,g.g)();return!!(t&&t[0]<15)}function y(t){if(t)return"string"==typeof t?t:t+"px"}const b=Symbol("__EventGroupName__");class S{constructor(){this._events={}}on(t,e,i){return Object.defineProperty(e,b,{value:i,writable:!0}),this._events[t]||(this._events[t]=[]),null!=(i=this._events[t])&&i.push(e),this}one(t,e,i){const s=(...i)=>{e(...i),this.off(t,s)};return Object.defineProperty(s,b,{value:i,writable:!0}),this._events[t]||(this._events[t]=[]),null!=(i=this._events[t])&&i.push(s),this}off(t,e){var i;return this._events[t]&&-1<(e=null!=(i=null==(i=this._events[t])?void 0:i.indexOf(e))?i:-1)&&null!=(i=this._events[t])&&i.splice(e,1),this}removeEventGroup(t){var e=e=>null==(e=this._events[e])?void 0:e.filter((e=>e[b]!==t));for(const t in this._events)this._events[t]=e(t);return this}trigger(t,...e){var i;return this._events[t]&&null!=(i=this._events[t])&&i.forEach((i=>{try{i(...e)}catch(e){this.off(t,i),this.trigger("error",e)}})),this}}class x extends S{constructor(){super(...arguments),this.applets={},this.residentApplets=[],this.presetAppletsView={},this.historyNodeLocation=history.length,this.routerRegExp=/([^#/]+)(.+)?/}resolveURL(t){var e=t=new URL(t,window.location.toString());return void 0===t.href&&(e.href=String(t)),e}verifyAppletSrcLegitimacy(t){var e=this.config.capture;if(e)return this.captureAppletSrc(t,e);if(0===(e=this.config.allowHosts||[]).length)return!0;e.push(location.host);var i=new URL(decodeURIComponent(t),window.location.toString()).host;for(const t of e)if(i===t)return!0;return!1}captureAppletSrc(t,e=this.config.capture){var i=this.resolveURL(t),s=i.origin+i.pathname;if("string"==typeof e){if(e===s)return!0}else if("function"==typeof e&&e(i,t))return!0;return!1}promiseApplet(t){return Promise.resolve(t())}checkIsPresetAppletsView(t){return this.residentApplets.includes(t)}delPresetAppletsView(t,e=!1){e&&!this.checkIsPresetAppletsView(t)&&(e=this.presetAppletsView[t])&&e.parentElement&&e.parentElement.removeChild(e),delete this.presetAppletsView[t]}setPrestAppletsView(t){this.residentApplets=Object.keys(t),this.presetAppletsView=t}setting(t){t.applets.frameworks.config.prerender||(t.applets.frameworks.config.prerender=Object.keys(t.applets)),this.options=t}}class T extends x{constructor(){var t;super(...arguments),this.overscrollHistoryNavigation={moment:0,type:""},this.properties={darkTheme:null==(t=null==(t=window.matchMedia)?void 0:t.call(window,"(prefers-color-scheme: dark)"))?void 0:t.matches},this.activeState="active"}get route(){var t=(e=this.routerRegExp.exec(location.hash)||[])[1],e=e[2],i=location.search;return{id:t?decodeURIComponent(t):"",param:e?decodeURIComponent(e):"",search:i}}get exists(){try{return parseInt(sessionStorage.getItem(location.pathname+"__EXISTS")||"-1",10)===history.length}catch(t){return!1}}get activityApplet(){var t=this.segue.id;return this.applets[t]}get prevActivityApplet(){var t=this.segue.prevId;return this.applets[t]}get activityLevel(){var t;return(null!=(t=null==(t=this.activityApplet)?void 0:t.level)?t:0)+1}get isFullscreen(){return document.body.offsetHeight===screen.height}setExists(){const t=location.pathname+"__EXISTS",e=String(history.length);return new Promise(((i,s)=>{try{sessionStorage.setItem(t,e),i()}catch(i){try{sessionStorage.clear(),sessionStorage.setItem(t,e)}catch(i){s()}}}))}activate(t){var e="application-"+(t=t?"active":"frozen");if(window.applicationActiveState!==t){this.activeState=t,this.trigger(t),window.applicationActiveState=t,window.postMessage({type:e},"*");for(const t in this.applets){var i=this.applets[t];i.sandbox&&!i.sameOrigin&&i.triggerWindow(e)}}}}s=(t,e)=>{var i=t.config;if(("frameworks"===e||"system"===e)&&(i.free&&(0,g.t)(1101,"warn"),null!=(s=i.source)&&s.html||null!=(s=i.source)&&s.src)&&(0,g.t)(1102,"warn"),!i.portal||i.free||(0,g.t)(1103,"warn"),1e4<(null!=(s=i.level)?s:0)&&(0,g.t)(1104,"warn"),"frameworks"===e||null!=(s=i.source)&&s.html||null!=(e=i.source)&&e.src){var s=["smart-setTimeout","proxy-link","tap-highlight"];const{apply:t=s,unApply:e}=i;i.apply=t,null!=e&&e.length&&(i.apply=null==t?void 0:t.filter((t=>!e.includes(t))))}else i.apply&&(0,g.t)(1202,"warn");return 0===(null==(e=i.modality)?void 0:e.indexOf("sheet"))?(i.animation&&(0,g.t)(1105,"warn"),i.animation="popup"):"popup"===i.animation&&(i.modality="sheet",(0,g.t)(1106,"warn")),i.modality&&(0===(null==(s=i.modality)?void 0:s.indexOf("paper"))?(i.animation&&(0,g.t)(1105,"warn"),({maskOpacity:e,swipeClosable:s}=i.paperOptions||{maskOpacity:.5}),i.animation="grow",i.sheetOptions={stillBackdrop:!0,noHandlebar:!0,maskOpacity:e,swipeClosable:s,borderRadius:"0px",top:"0px"}):0===(null==(e=i.modality)?void 0:e.indexOf("overlay"))&&(i.animation&&(0,g.t)(1105,"warn"),i.color||(i.color="transparent"),({maskOpacity:s,swipeClosable:e}=i.overlayOptions||{maskOpacity:.5}),i.animation="popup",i.sheetOptions={stillBackdrop:!0,noHandlebar:!0,maskOpacity:s,swipeClosable:e,borderRadius:"0px",top:"0px",useFade:!0}),i.sheetOptions||(i.sheetOptions={}),(0,g.g)()||(i.sheetOptions.stillBackdrop=!0)),i.animation||(i.disableSwipeModel=!0),i.swipeTransitionType||(i.swipeTransitionType=null!=(s=i.swipeTransitionType)?s:(0,g.g)()?"slide":"zoom"),t};class V extends S{constructor(t,e,i){super(),this.param="",this.slide=null,this.modality=null,this.view=null,this.img=null,this.snapshot=null,this.snapshotTime=-1,this.visitTime=-1,this.events={transformStart:()=>{},transformEnd:()=>{},boot:()=>{},load:()=>{},loadError:()=>{},preload:()=>{},destroy:()=>{}},this.darkTask=[],this.createTime=Date.now(),this.transient=!1,this.config={title:"",level:0,source:{},prerender:[],apply:void 0,background:"auto",free:!1},this.components=[],this.resources={script:[],image:[],worker:[],video:[],audio:[],font:[],style:[]},this.setDefaultConfig=s,this.id=t,this.model=e,this.application=i;var{config:i,resources:e,events:t,components:o}=this.setDefaultConfig(e,t);Object.assign(this.config,i),Object.assign(this.resources,e),Object.assign(this.events,t),o&&(this.components=o),this.application.segue.preloadAnimation(this.self)}get self(){return this.application.applets[this.id]||this}}class k extends V{constructor(){super(...arguments),this.visibility=!1,this.transforming=!1,this.viewLevel=0,this.status={preload:!1,prefetch:!1,prerender:!1,refreshing:!1,requestRefresh:!1}}get swipeModel(){var t;return"default"!==this.application.config.swipeModel||"ontouchend"in document&&9<=(null!=(t=null==(t=(0,g.g)())?void 0:t[0])?t:0)&&"default"}get sameOrigin(){return this.uri?new URL(this.uri,window.location.toString()).host===location.host:void 0===this.config.sandbox||!!this.config.sandbox.includes("allow-same-origin")}get level(){var t;return null!=(t=this.config.level)?t:0}setLevel(t){this.viewLevel=t}get rel(){return"system"===this.id?"system":"frameworks"===this.id?"frameworks":"applet"}get uri(){var t;return(null==(t=null==(t=this.config)?void 0:t.source)?void 0:t.src)||""}get source(){var t=(null==(t=null==(t=this.config)?void 0:t.source)?void 0:t.html)||"";return"string"==typeof t?t:t()}get hasSource(){var t;return!!(this.uri||null!=(t=null==(t=this.config)?void 0:t.source)&&t.html)}get noSource(){return!this.hasSource&&!this.config.render}get viewType(){var t;return"applet"===this.rel&&this.hasSource?null!=(t=this.config)&&t.portal&&this.sameOrigin?"portal":"iframe":"shadow"}get color(){var t,e;return"applet"!==this.rel?"transparent":(e=(t=this.application).properties.darkTheme,e=""+(this.config.color||(e?"#000":"#fff")),"frameworks"!==this.id&&"inherit"==e&&t.applets.frameworks.config.color||e)}get expired(){var t;return!!this.view&&!(null!=(t=this.application.prevActivityApplet)&&t.config.modality||!(this.status.requestRefresh||Date.now()-this.createTime>=(null!=(t=this.config.timeout)?t:6e7)))}get isModality(){return!!this.config.modality}get isFullscreen(){return!this.isModality}get isPresetAppletsView(){return this.application.checkIsPresetAppletsView(this.id)}get useControls(){return!0!==this.config.disableSwipeModel&&this.swipeModel&&"applet"===this.rel&&this.isFullscreen}get noShadowDom(){return"shadow"===this.viewType&&!!this.config.noShadowDom}get mirroringString(){try{return localStorage.getItem("__MODULE_IMG__"+this.id)||""}catch(t){return""}}get contentWindow(){var t;return null!=(t=null==(t=null==(t=this.sandbox)?void 0:t.window)?void 0:t.window)?t:window}get contentDocument(){var t;if(this.sameOrigin)return"shadow"===this.viewType?this.viewport:null==(t=this.sandbox)?void 0:t.document}get mirroringHTML(){if("shadow"===this.viewType)return null!=(t=null==(t=this.view)?void 0:t.outerHTML)?t:"";if(!this.sameOrigin)return"";var t=null==(t=this.sandbox)?void 0:t.sandbox;const e=["script","template"];try{var i=t.contentDocument;if(!i)return"";var s=i.querySelectorAll("*");const o=[];return s.forEach((t=>{var i=t.tagName;e.includes(i)||(-1!==i.indexOf("-")&&(t.style.visibility="hidden"),o.push(t.outerHTML))})),o.join("\n")}catch(t){return""}}get subApplet(){if(this.slide)return this.application.applets[this.slide.activeId]}get allSubAppletIds(){var t=[];if(this.slide)for(const e of this.slide.slideViewApplets)t.push(e.id);return t}resume(){this.status={preload:!1,prefetch:!1,prerender:!1,refreshing:!1,requestRefresh:!1},this.darkTask=[],this.view=null,this.img=null,this.slide&&(this.slide=null),this.modality&&(this.modality=null)}saveMirroring(){if(!this.config.useMirroring||!this.sameOrigin)return Promise.resolve(!1);var t="__MODULE_IMG__"+this.id,e=null!=(e=this.mirroringHTML)?e:"";try{return localStorage.setItem(t,e),Promise.resolve(!0)}catch(i){return localStorage.clear(),localStorage.setItem(t,e),Promise.resolve(!1)}}setActionOrigin(t){t&&(this.segueActionOrigin=t)}getActionOrigin(){return this.segueActionOrigin}injectWindowVisibilityState(t){var e;this.sameOrigin&&(e=this.contentWindow)&&(e.appletVisibilityState=t)}triggerWindow(t){var e;null!=(e=this.contentWindow)&&e.postMessage({type:t,appletId:this.id,historyDirection:this.application.segue.historyDirection},"*")}}o=window.setBackgroundTimeout||window.setTimeout,n=window.requestIdleCallback||((t,e)=>{const i=Date.now();return o((function(){t({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-i))}})}),Math.min(null!=(e=null==e?void 0:e.timeout)?e:1,1))}),r=window.requestAnimationFrame||o,l=(t=0)=>new Promise((e=>{o(e,t)}));class A extends k{attach(t,e,i){t&&(this.viewport=t,this.parentApplet=e,this.mountBehavior=i)}removeContainer(){var t;this.isPresetAppletsView||(null!=(t=null==(t=this.contentView)?void 0:t.parentElement)&&t.removeChild(this.contentView),null!=(t=null==(t=this.viewport)?void 0:t.parentNode)&&t.removeChild(this.viewport),this.viewport=void 0,this.delPresetView())}clearContainer(){var t;this.isPresetAppletsView||(null!=(t=null==(t=this.contentView)?void 0:t.parentElement)&&t.removeChild(this.contentView),this.viewport&&(this.viewport.innerHTML=""),this.delPresetView())}delPresetView(){this.contentView=void 0,this.application.delPresetAppletsView(this.id,!0)}setParam(t){return this.param!==t?(this.param=t,this.destroy(!0)):Promise.resolve(!0)}show(){var t,e=this.viewType;if("portal"===e)null!=(t=this.view)&&t.activate();else{for(const t of this.darkTask)t();this.transforming=!1,this.darkTask=[],this.visibility=!0,this.visitTime=Date.now(),this.trigger("show"),"iframe"===e&&(this.triggerWindow("applet-show"),this.injectWindowVisibilityState("visible")),null!=(t=this.subApplet)&&t.show()}}hide(){var t;this.transforming=!1,this.visibility=!1,this.trigger("hide"),"iframe"===this.viewType&&(this.triggerWindow("applet-hidden"),this.injectWindowVisibilityState("hidden")),null!=(t=this.subApplet)&&t.hide()}willShow(){var t;this.transforming=!0,this.trigger("willShow"),"iframe"===this.viewType&&(this.triggerWindow("applet-will-show"),this.injectWindowVisibilityState("willVisible")),null!=(t=this.subApplet)&&t.willShow()}willHide(){var t;this.transforming=!0,this.trigger("willHide"),"iframe"===this.viewType&&(this.triggerWindow("applet-will-hide"),this.injectWindowVisibilityState("willHidden")),null!=(t=this.subApplet)&&t.willHide()}willSegueShow(){this.trigger("willSegueShow")}willSegueHide(){this.trigger("willSegueHide")}destroy(t=!1,e=!0){return e&&[...this.allSubAppletIds,...null!=(e=null==(e=this.parentApplet)?void 0:e.allSubAppletIds)?e:[]].forEach((t=>null==(t=this.application.applets[t])?void 0:t.destroy(!1,!1))),new Promise((e=>{var i;return this.view?this.isPresetAppletsView||"frameworks"===this.rel||"system"===this.rel||(null==(i=this.application.segue)?void 0:i.id)===this.id&&!1===t?e(!1):("iframe"===this.viewType&&this.unload(),!1===t?this.removeContainer():this.clearContainer(),this.resume(),null!=(i=this.events)&&i.destroy(this.self),this.application.removeEventGroup(this.id),this.trigger("destroy"),void e(!0)):e(!0)}))}observer(t){var e,i=this.sandbox?null==(i=this.sandbox.document)?void 0:i.documentElement:this.view;if(i)return(e=new MutationObserver((e=>{t(e)}))).observe(i,{subtree:!0,attributes:!0,childList:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0}),e}collectAllElements(t){function e(t){for(let o=0;o<t.length;o++){var s=t[o];i.push(s),s.shadowRoot&&e(s.shadowRoot.querySelectorAll("*"))}}const i=[];return t.shadowRoot&&e(t.shadowRoot.querySelectorAll("*")),e(t.querySelectorAll("*")),i}autoMediaController(t){return new Promise(((e,i)=>{try{if("iframe"!==this.viewType)return e();if(void 0===this.sandbox)return e();var s=t.filter((t=>"video"===t.tagName||"audio"===t.tagName));for(const t in s){const e=s[t];null!=e&&e.paused||(e.pause(),this.darkTask.push((()=>{e.play()})))}}catch(e){i()}}))}destructiveTags(t){const e=["object","embed","applet","iframe"];return!!t.filter((t=>e.includes(t.tagName))).length}guarding(){return new Promise((t=>{var e;if("applet"!==this.rel)return t(!0);if(void 0===this.sandbox)return t(!0);if(!0===this.config.background)return t(!0);if(!1===this.config.background)return t(!1);if(!1===this.sameOrigin)return t(!1);var i=this.view;try{var s=null==(e=i.contentDocument)?void 0:e.documentElement;if(!s)return t(!0);var n=this.collectAllElements(s);if(this.config.mediaGuard&&this.autoMediaController(n).catch(t),this.destructiveTags(n))return t(!1);if(this.config.observerGuard){const e={times:0};var r=this.observer((()=>{e.times++,1e3<e.times&&(t(!1),this.mutationObserver.disconnect())}));r&&(this.mutationObserver=r,o((()=>{10<e.times&&t(!1)}),3e3))}}catch(e){t(!0)}}))}cancelGuard(){var t;null!=(t=this.mutationObserver)&&t.disconnect()}unload(t){var e;return void 0===t&&(t=null==(e=this.sandbox)?void 0:e.sandbox),new Promise((e=>{var i,s;if(this.cancelGuard(),!t)return e();t===(null==(s=this.sandbox)?void 0:s.sandbox)&&this.saveMirroring();try{t.contentWindow&&(t.contentWindow.onunload=null),t.style.display="none",t.src="about:blank";var o=null==(i=t.contentWindow)?void 0:i.window,n=t.contentDocument;null!=o&&o.location.reload(),null!=n&&n.open(),null!=n&&n.write(""),null!=n&&n.close()}catch(e){}null!=(s=t.parentNode)&&s.removeChild(t),e()}))}}class C{constructor(t,e,i="src"){this.blankURL="about:blank";var s=this.sandbox=document.createElement("iframe");return s["source"===i&&t?"srcdoc":"src"]=t||this.blankURL,s.style.display="none",this.setting=e,this}get window(){return this.sandbox.contentWindow}get document(){return this.sandbox.contentDocument}get origin(){return this.src===this.blankURL?null:this.src}set src(t){this.sandbox.src=t}setOnUnload(t){try{return this.window.onunload=t,Promise.resolve()}catch(t){return Promise.reject(t)}}setOnLoad(t){try{return this.sandbox.onload=t,Promise.resolve()}catch(t){return Promise.reject(t)}}setOnError(t){try{return this.sandbox.onerror=t,Promise.resolve()}catch(t){return Promise.reject(t)}}set(t=this.setting){void 0!==t&&this.sandbox.setAttribute("sandbox",t)}reset(t){return this.exit(),this.set(t),this}open(){var t;return null!=(t=this.document)&&t.open(),this}write(t='<head><meta charset="utf-8"></head>'){var e;return t="<!DOCTYPE html>"+t,null!=(e=this.document)&&e.write(t),this}close(){var t;return null!=(t=this.document)&&t.close(),this}append(t){this.open(),this.write(t),this.close()}enter(t){this.set(),t.appendChild(this.sandbox)}exit(){var t=this.sandbox.parentNode;t&&t.removeChild(this.sandbox)}}class P extends A{dependenciesLoad(t,e="src"){return new Promise(((i,s)=>{var o=document.head;const n=new C(t,"",e);n.setOnLoad((t=>{setTimeout((()=>{n.exit()}),2e3),i(t)})),n.setOnError((t=>{n.exit(),s(t)})),n.enter(o)}))}preload(){return(0,g._)(this,void 0,void 0,(function*(){return this.dependenciesLoad(this.uri||(yield this.source),this.uri?"src":"source").then((()=>{var t;this.status.preload=!0,null!=(t=this.events)&&t.preload(this.self),this.trigger("preload")}))}))}prefetch(){return new Promise(((t,e)=>{Promise.all([this.prefetchStatic(this.resources.script,"script"),this.prefetchStatic(this.resources.image,"image"),this.prefetchStatic(this.resources.worker,"worker"),this.prefetchStatic(this.resources.video,"video"),this.prefetchStatic(this.resources.audio,"audio"),this.prefetchStatic(this.resources.font,"font"),this.prefetchStatic(this.resources.style,"style"),this.prefetchStatic(this.resources.html,"document")]).then((()=>{this.status.prefetch=!0,this.trigger("prefetch"),t(!0)})).catch(e)}))}prefetchStatic(t=[],e="script"){return new Promise(((i,s)=>{Promise.all([].concat(t).map((t=>this.prelink(t,"preload",e)))).then(i).catch(s)}))}prelink(t,e="preload",i="worker | video | audio | font | script | style | image | document"){return t?new Promise(((s,o)=>{n((()=>{var n,r=document.createElement("link");if(r.rel=e,r.href=t,r.as=i,r.onload=s,r.onerror=o,"preload"===e&&"document"===i&&this.dependenciesLoad(t),null==(n=r.relList)||!n.supports(e))return s(void 0);document.getElementsByTagName("head")[0].appendChild(r),s(void 0)}),{timeout:15e3})})):Promise.resolve(void 0)}prerender(){return(0,g._)(this,void 0,void 0,(function*(){return this.status.preload||this.status.prerender||(yield this.preload(),yield this.prefetch()),Promise.resolve()}))}}class L extends P{constructor(){super(...arguments),this.borderHolder=[],this.getTouchBorderType=t=>{var e=(i=this.viewport).offsetWidth,i=i.offsetHeight,s=(t=t.touches[0]).clientX,o=(t=t.clientY,[]),n=null!=(n=this.config.borderTouchSize)?n:100;return s<=n?o.push("left"):e-n<=s&&o.push("right"),t<=n?o.push("top"):i-n<=t&&o.push("bottom"),o}}attachEvent(){this.registerBorderTouch(),this.bindOverscrollHistoryNavigation(),this.registerTapStatusBarToScrollToTop(),this.registerPullToRefresh()}scrollToTop(){const t=this.getMainScroller();t&&Promise.resolve().then((function(){return a})).then((({SmoothScroller:e})=>{new e(t).scrollTo(0,0)})).catch((t=>{console.warn(t)}))}registerPullToRefresh(){if(this.config.pullToRefresh)if(this.application.pullRefreshHolder.holder){const t=this.application.pullRefreshHolder.holder,e=this.application.pullRefreshHolder.spinner,s=this.application.pullRefreshHolder.holdLayer,o=this.getMainScroller(this.config.pullToRefreshTargetScrollId);o&&i.e(461).then(i.bind(i,7461)).then((i=>{i.registerPullDownEvent(this.self,o,t,e,s)})).catch((t=>{console.warn(t)}))}else this.application.on("pullToRefreshAvailable",(()=>{this.registerPullToRefresh()}))}registerTapStatusBarToScrollToTop(){this.config.tapStatusBarToScrollToTop&&this.borderHolder[0].addEventListener("touchend",(()=>{this.scrollToTop()}))}getMainScroller(t=this.config.mainScrollId){var e;let i;return"shadow"===this.viewType?i=t?(null==(e=null==(e=this.view)?void 0:e.shadowRoot)?void 0:e.getElementById(t))||document.getElementById(t):this.contentView:this.sameOrigin&&(e=null==(e=this.sandbox)?void 0:e.window,i=t?null==e?void 0:e.document.getElementById(t):null==e?void 0:e.document.body),i}bindOverscrollHistoryNavigation(){this.on("touchBorder",((t,e)=>{"touchmove"===e.type&&(t.includes("left")||t.includes("right")||t.includes("wipe"))&&(e=Date.now(),t=t.join(" "),this.application.overscrollHistoryNavigation.moment=e,this.application.overscrollHistoryNavigation.type=t,parent.postMessage({type:"overscrollHistoryNavigationStatusChange",data:[e,t]},"*"))}))}addBorderPanMoveHolder(t){var e=null!=(e=this.config.borderTouchSize)?e:15,i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div");return i.style.cssText=`position: absolute; z-index: 3; top: 0; right: 0; left: 0; height: env(safe-area-inset-top); mini-height: ${e}px;`,s.style.cssText=`position: absolute; z-index: 3; top: 0; right: 0; bottom: 0; z-index: 3; width: ${e}px;`,o.style.cssText=`position: absolute; z-index: 3; right: 0; bottom: 0; left: 0; z-index: 3; height: ${e}px;`,n.style.cssText=`position: absolute; z-index: 3; top: 0; bottom: 0; left: 0; z-index: 3; width: ${e}px;`,r.style.cssText="display: none; position: absolute; z-index: 3; top: 0; right: 0; bottom: 0; left: 0; z-index: 4;",t.appendChild(i),t.appendChild(s),t.appendChild(o),t.appendChild(n),t.appendChild(r),this.borderHolder=[i,s,o,n,r]}registerBorderHolderTouch(){const[t,e,i,s,o]=this.addBorderPanMoveHolder(this.viewport),n=[],r=o.addEventListener,l=o.removeEventListener,a=t=>{this.trigger("touchBorder",n,t)},h=l=>{n.length=0,l.target===t?n.push("top"):l.target===e?n.push("right"):l.target===i?n.push("bottom"):l.target===s&&n.push("left"),o.style.display="block",r("touchmove",a,!0),r("touchend",a,!0),r("touchcancel",a,!0)},p=()=>{o.style.display="none",l("touchmove",a,!0),l("touchend",a,!0),l("touchcancel",a,!0)};var c=t=>{(t=t.addEventListener)("touchstart",h,!0),t("touchmove",h,!0),t("touchcancel",p,!0),t("touchend",p,!0)};c(t),c(e),c(i),c(s)}registerBorderTouch(){var t;if(this.sandbox&&!this.sameOrigin)return this.registerBorderHolderTouch();const e=(null==(t=null==(t=this.sandbox)?void 0:t.window)?void 0:t.document)||this.viewport,i=[],s=t=>{this.trigger("touchBorder",i,t),"touchend"!==t.type&&"touchcancel"!==t.type||(e.removeEventListener("touchmove",s,!0),e.removeEventListener("touchend",s,!0),e.removeEventListener("touchcancel",s,!0))};e.addEventListener("touchstart",(t=>{i.length=0,i.push(...this.getTouchBorderType(t)),this.transforming&&i.push("wipe"),0<i.length&&(e.addEventListener("touchmove",s,!0),e.addEventListener("touchend",s,!0),e.addEventListener("touchcancel",s,!0))}),!0)}}const E=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,I=(0,g.a)(),H=f(),_=!I&&/Mac OS X [0-9][0-9]_/g.exec(navigator.userAgent);class O{constructor(t,e=!1){this.touchHold=!1,this.scrollType="scroll",this.scrollHold=null,this.scrolling=!1,this.reservePlanId=-1,this.scrollDuration=400,this.checkScrollEnd=(t,e)=>this.element.scrollLeft===t&&this.element.scrollTop===e,this.element=t,!I&&e&&(t.addEventListener("touchstart",this.scrollStop,!0),t.addEventListener("touchend",this.scrollContinue,!0),t.addEventListener("touchcancel",this.scrollContinue,!0))}snapTo(t,e,i){return(0,g._)(this,void 0,void 0,(function*(){return this.touchHold=!1,this.scrollType="snap",this.smoothScroll(t,e,i)}))}scrollTo(t,e,i){return(0,g._)(this,void 0,void 0,(function*(){return this.touchHold=!1,this.scrollType="scroll",this.smoothScroll(t,e,i)}))}scrollStop(){this.touchHold=!0}scrollContinue(){var t;this.touchHold=!1,null!=(t=this.scrollHold)&&t.call(this)}catchDefaultStyle(){var t;!0!==this.scrolling&&(t=this.element.style,this.defaultScrollBehavior=t.scrollBehavior||"smooth")}isBreak(){return!("ontouchend"in document||void 0===this.preStep||this.preStep[0]===this.element.scrollLeft&&this.preStep[1]===this.element.scrollTop||(this.scrollStop(),0))}step(t){if(this.touchHold){if("scroll"===this.scrollType)return t.end();this.scrollHold=()=>{this.step(t)}}var e=E();e=(t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2)(e=Math.min((e-t.startTime)/t.duration,1));let i=t.startX+(t.x-t.startX)*e,s=t.startY+(t.y-t.startY)*e;e=0<t.x-t.startX?1:-1;var o=0<t.y-t.startY?1:-1;(1==e&&i>t.x||-1==e&&i<t.x)&&(i=t.x),(1==o&&s>t.y||-1==o&&s<t.y)&&(s=t.y),this.isBreak()||(this.element.scrollLeft=i,this.element.scrollTop=s,this.element.scrollTo(i,s),this.preStep=[this.element.scrollLeft,this.element.scrollTop],i!==t.x||s!==t.y?r((()=>{this.step(t)})):(t.end(),this.scrollHold=null))}openSmooth(){this.element.style.scrollBehavior="smooth",_&&(this.element.style.scrollSnapType=this.defaultScrollSnapType)}closeSmooth(){this.element.style.scrollBehavior="auto",_&&(this.defaultScrollSnapType=this.element.style.scrollSnapType,this.element.style.scrollSnapType="none")}beforeScrolling(){this.catchDefaultStyle(),this.preStep=void 0,this.scrolling=!0}endScrolling(){this.element.style.scrollBehavior=this.defaultScrollBehavior||"smooth",this.scrolling=!1}smoothScroll(t,e,i){if("scroll"===this.scrollType&&!I||"snap"===this.scrollType&&!H)return this.smoothScrollByStep(t,e);let s=-1;return new Promise((n=>{const r=()=>{clearTimeout(s),s=o((()=>(0,g._)(this,void 0,void 0,(function*(){this.element.removeEventListener("scroll",r,!1),n()}))),100)};this.element.addEventListener("scroll",r,!1),this.beforeScrolling(),this.openSmooth(),this.checkScrollEnd(t,e)&&(this.endScrolling(),n()),this.element.scrollTo(t,e),clearTimeout(this.reservePlanId),this.reservePlanId=o((()=>(0,g._)(this,void 0,void 0,(function*(){-1===s&&(yield this.smoothScrollByStep(t,e,i),n())}))),600)}))}smoothScrollByStep(t,e,i=this.scrollDuration){return this.beforeScrolling(),this.closeSmooth(),new Promise((s=>{this.step({startTime:E(),startX:this.element.scrollLeft,startY:this.element.scrollTop,x:t,y:e,duration:i,end:()=>{this.endScrolling(),s()}})}))}}a=Object.freeze({__proto__:null,SmoothScroller:O});const B="\n  width: 100%;\n  height: 100%;\n  min-width: 100%;\n  min-height: 100%;\n  max-width: 100%;\n  max-height: 100%;\n",M=`\n  inset: 0px;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  ${B}\n`,R="\n  filter: none;\n  opacity: 1;\n",D=`\n  position: relative;\n  display: flex;\n  ${B}\n  scroll-snap-align: start;\n  scroll-snap-stop: always;\n`,z=`\n  ${D}\n  background: rgba(0, 0, 0, .3);\n  opacity: 0;\n`,N=`\n  position: relative;\n  display: flex;\n  ${B}\n  flex-direction: row;\n  overflow: auto;\n  scroll-behavior: auto;\n  scroll-snap-type: both mandatory;\n`,j=`\n  position: fixed;\n  ${M}\n  z-index: 9;\n  display: none;\n`;class U extends class extends class extends class extends class{constructor(t){this.backdropReducedScale=.03,this.applet=t,this.application=t.application,this.appletViewport=this.applet.viewport}}{constructor(){super(...arguments),this.advanceDegree=0,this.swipeTransitionType=this.application.config.swipeTransitionType}get visibility(){return 0!==Math.round(this.controlsView.scrollLeft/this.appletViewport.offsetWidth)}get viewports(){return this.fromViewports||(this.fromViewports=this.application.segue.viewports)}get degree(){return this.controlsView.scrollLeft/this.appletViewport.offsetWidth}get activity(){return this.application.activityApplet===this.applet}clearFromViewports(){this.fromViewports=void 0}}{constructor(){super(...arguments),this.available=!0,this.toggleLock=!1,this.slidingListener=this.sliding.bind(this)}requestGoBack(t){this.applet.transforming||!1===this.toggleLock&&t<=this.advanceDegree&&this.activity&&(this.toggleLock=!0,setTimeout((()=>{this.toggleLock=!1}),300),this.application.segue.back("controls").then((()=>{this.fromViewports=void 0})))}sliding(){var t=this.applet,e=this.viewports[1],i=this.swipeTransitionType,s=this.degree;this.requestGoBack(s),this.backdropView.animate([{opacity:s}],{duration:0,fill:"forwards"}).play();let o=1<s?`rgba(0, 0, 0, ${.5+3*(s-1)})`:"transparent";if(this.controlsView.animate([{backgroundColor:o}],{duration:0,fill:"forwards"}).play(),e&&t.visibility&&!t.transforming&&!this.toggleLock){let t="slide"===i?`translate3d(${30*-s}%, 0, 0)`:`scale(${1-.03*s})`;e.animate([{transform:t}],{duration:0,fill:"forwards"}).play()}this.application.trigger("transition",s,this.application.segue.appletGroup)}bindSlidingEvent(){this.controlsView.addEventListener("scroll",this.slidingListener)}removeSlidingEvent(){this.controlsView.removeEventListener("scroll",this.slidingListener)}bindBaseEvent(){this.backdropView.addEventListener("touchstart",(()=>(0,g._)(this,void 0,void 0,(function*(){yield this.hide(),this.requestGoBack(this.degree)})))),this.controlsOverlay.addEventListener("touchstart",(t=>{t.stopPropagation(),t.preventDefault()}),!1),this.applet.on("willShow",(()=>{this.application.segue.stackUp&&this.clearFromViewports()})),this.applet.on("show",(()=>{this.visibility||this.appearImmediately(),this.application.segue.stackUp&&this.prepare()})),this.applet.on("hide",(()=>{this.visibility&&this.application.segue.fromOverscrollHistoryNavigation&&this.disappearImmediately()}))}prepare(t=!1){var e=this.viewports,i=this.swipeTransitionType;if(e=e[1]){let s="";s="slide"===i?t?"translate3d(0, 0, 0)":"translate3d(-30%, 0, 0)":t?"scale(1)":`scale(${1-this.backdropReducedScale})`,e.animate([{transform:s}],{duration:0,fill:"forwards"}).play()}}switch(t){return(0,g._)(this,void 0,void 0,(function*(){return this.controlsOverlay.style.display="block",this.toggleLock=!0,this.scroll.snapTo(t?this.appletViewport.offsetWidth:0,0).then((()=>{this.toggleLock=!1,this.controlsOverlay.style.display="none"}))}))}disappearImmediately(){return(0,g._)(this,void 0,void 0,(function*(){this.controlsView.style.scrollBehavior="auto",this.controlsView.scrollLeft=1+this.advanceDegree}))}appearImmediately(){return(0,g._)(this,void 0,void 0,(function*(){this.controlsView.style.scrollBehavior="auto",this.controlsView.scrollLeft=this.appletViewport.offsetWidth}))}show(){return(0,g._)(this,void 0,void 0,(function*(){return this.switch(!0).then((()=>{this.bindSlidingEvent()}))}))}hide(){return(0,g._)(this,void 0,void 0,(function*(){return this.switch(!1).then((()=>{this.removeSlidingEvent()}))}))}disable(){this.available=!1}enable(){this.available=!0}activate(){!1!==this.available&&(this.backdropView.style.display="block",this.controlsView.style.overflow="auto",this.controlsView.scrollLeft=this.appletViewport.offsetWidth,this.bindSlidingEvent())}freeze(){this.removeSlidingEvent(),this.backdropView.style.display="none",this.controlsView.style.overflow="hidden"}}{attach(){this.controlsView=document.createElement("applet-controls"),this.contentContainer=document.createElement("applet-container"),this.backdropView=document.createElement("applet-backdrop"),this.controlsOverlay=document.createElement("applet-controls-overlay"),this.scroll=new O(this.controlsView)}buildControlsView(){var t=document.createElement("style");t.innerHTML="\n  applet-controls::-webkit-scrollbar {\n    display: none;\n  }\n  applet-controls::scrollbar {\n    display: none;\n  }\n",this.contentContainer.style.cssText=D,this.backdropView.style.cssText=z,this.controlsView.style.cssText=N,!1===(0,g.b)()&&(this.controlsView.style.cssText+="-webkit-overflow-scrolling: touch;"),this.controlsOverlay.style.cssText=j,this.controlsView.appendChild(this.backdropView),this.controlsView.appendChild(this.contentContainer),this.appletViewport.appendChild(t),this.appletViewport.appendChild(this.controlsView),this.appletViewport.appendChild(this.controlsOverlay)}create(){this.attach(),this.buildControlsView(),this.bindBaseEvent();var t=this.applet;return("applet"!==t.rel||!1===t.swipeModel||null!=(t=t.mountBehavior)&&t.noSwipeModel)&&this.freeze(),this.contentContainer}}{}const $=`\n  display: flex;\n  ${B}\n  scroll-snap-align: start;\n  scroll-snap-stop: always;\n  transform: translate(0, 0);\n`,F=`\n  position: fixed;\n  ${M}\n  z-index: 7;\n  display: none;\n`;class W extends class extends class extends class extends class{constructor(t,e={openSlideViewLeftHolder:!0,slideViewSnapType:"x",slideViewGridRepeat:0},i=t.viewport){this.scrolling=!1,this.switching=!1,this.distance=0,this.activeId="",this.snapType="x";var s=t.config.defaultSlideViewApplets;s&&i&&(this.applet=t,this.application=t.application,this.slideViewApplets=s,this.options=e,this.snapType=e.slideViewSnapType)}}{get index(){var t=this.slideView;return(Math.round(t.scrollLeft/t.offsetWidth)+1)*(Math.round(t.scrollTop/t.offsetHeight)+1)-1}get slidingState(){if(this.slidingStateCatch)return this.slidingStateCatch;const t=this.slideView;return this.slidingStateCatch={get x(){return t.scrollLeft},get y(){return t.scrollTop},get xIndex(){return Math.round(t.scrollLeft/t.offsetWidth)},get yIndex(){return Math.round(t.scrollTop/t.offsetHeight)}}}getAppletIdByIndex(t){return null==(t=this.slideViewApplets[t])?void 0:t.id}getAppletIndexById(t){if("number"==typeof t)return t;let e=0;for(const i of this.slideViewApplets){if(i.id===t)return e;e++}return 0}}{constructor(){super(...arguments),this.hasSmoothSnapScrolling=f(),this.scrollCancelTimeoutId=-1,this.scrollCycleTimeout=300}closeOverlay(){this.slideViewOverlay.style.display="none"}openOverlay(){this.slideViewOverlay.style.display="block"}bindHolderEvent(){var t=t=>{t.stopPropagation(),this.openOverlay(),this.slideView.style.overflowX="hidden"};const e=()=>{this.closeOverlay(),this.slideView.style.overflowX="auto",this.slideView.removeEventListener("touchcancel",e,!0),this.slideView.removeEventListener("touchend",e,!0)};this.slideViewHolder.addEventListener("touchstart",t,!0),this.slideViewHolder.addEventListener("touchmove",t,!0),this.slideViewHolder.addEventListener("touchcancel",e,!0),this.slideViewHolder.addEventListener("touchend",e,!0)}dispatchScrollEvent(){this.application.activate(!1),this.applet.trigger("sliding",this.slidingState)}bindScrollEvent(){const t=this.slideView;t.addEventListener("scroll",(()=>{this.switching||(this.scrolling||(this.freezeAll(),this.scrolling=!0),this.dispatchScrollEvent(),clearTimeout(this.scrollCancelTimeoutId),this.scrollCancelTimeoutId=o((()=>(0,g._)(this,void 0,void 0,(function*(){this.hasSmoothSnapScrolling||(yield this.scroller.scrollTo(this.slidingState.xIndex*this.slideView.offsetWidth,this.slidingState.yIndex*t.offsetHeight)),this.scrolling=!1,this.activate(this.index),this.application.activate(!0)}))),this.scrollCycleTimeout))}))}destroy(t){return(0,g._)(this,void 0,void 0,(function*(){var e=this.getAppletIdByIndex(t);return(e=e&&this.application.applets[e])?!1!==e.config.background?Promise.resolve(!1):e.destroy(!0):Promise.resolve(!0)}))}freeze(t){return(0,g._)(this,void 0,void 0,(function*(){var e=this.getAppletIdByIndex(t);return e?this.application.get(e).then((t=>{t.hide(),this.applet.trigger("slideOut",t)})):Promise.resolve()}))}activate(t){return(0,g._)(this,void 0,void 0,(function*(){const e=this.getAppletIdByIndex(t);return e?this.application.get(e).then((t=>(0,g._)(this,void 0,void 0,(function*(){return t.show(),this.applet.trigger("slideEnter",t),e!==this.activeId&&this.destroy(this.getAppletIndexById(this.activeId)),this.activeId=e,t.view&&t.visibility?Promise.resolve():t.build()})))):Promise.resolve()}))}freezeAll(){var t=this.slideViewApplets.length;for(let e=0;e<=t;e++)this.freeze(e)}to(t,e=!0){return(0,g._)(this,void 0,void 0,(function*(){var i,s,o=this.getAppletIndexById(t),n=this.slideView;let r=0,l=0;return"x"===this.options.slideViewSnapType?(s=(i=n.offsetWidth)*this.slideViewApplets.length,r=Math.min(Math.max(o*i,0),s)):(s=(i=n.offsetHeight)*this.slideViewApplets.length,l=Math.min(Math.max(o*i,0),s)),this.index!==o&&(yield this.freeze(this.index)),!1===e?(n.style.scrollBehavior="auto",n.scrollLeft=r,n.scrollTop=l,n.style.scrollBehavior="smooth",Promise.resolve()):(this.switching=!0,this.openOverlay(),this.application.activate(!1),this.scroller.snapTo(r,l).then((()=>{this.closeOverlay(),this.switching=!1,this.activate(this.index),this.application.activate(!0)})))}))}}{constructor(t,e,i){super(t,e,i),this.scrolling=!1,this.switching=!1,this.distance=0,this.activeId="",this.createSlideView(this.slideViewApplets,i),this.bindScrollEvent(),this.bindHolderEvent(),this.scroller=new O(this.slideView)}resetViewportStyle(t){t.style.cssText=$}createSlideView(t,e){const i=document.createElement("slideView-viewport");var s=document.createElement("style");const o=document.createElement("slideView-holder");var r=document.createElement("slideView-overlay"),l=this.snapType,a=null!=(a=this.options.slideViewGridRepeat)?a:2;s.innerHTML="\n  slideView-viewport::-webkit-scrollbar {\n    display: none;\n  }\n  slideView-viewport::scrollbar {\n    display: none;\n  }\n",i.style.cssText=((t,e,i)=>`\n    ${"y"===t?"overflow-y: auto; overflow-x: hidden;":"x"===t?"display: flex; overflow-x: auto; overflow-y: hidden;":`\n      display: grid;\n      overflow: auto;\n      grid-template-columns: repeat(${e}, 100%);\n      grid-template-rows: repeat(${e}, 100%);\n    `}\n    position: absolute;\n    ${M}\n    z-index: 2;\n    scroll-behavior: ${i?"smooth":"auto"};\n    scroll-snap-type: ${t} mandatory;\n  `)(l,a,this.hasSmoothSnapScrolling),!1===(0,g.b)()&&(i.style.cssText+="-webkit-overflow-scrolling: touch;"),o.style.cssText="\n  position: absolute;\n  top: 15%;\n  bottom: 15%;\n  left: 0;\n  width: 15px;\n  z-index: 5;\n",r.style.cssText=F,r.addEventListener("touchstart",(t=>{t.stopPropagation(),t.preventDefault()}),!0),r.addEventListener("touchend",(()=>{this.closeOverlay()}),!0),t.forEach(((t,e)=>{const{id:s,activate:r}=t,l=document.createElement("applet-viewport");l.id="applet-viewport-"+s,this.resetViewportStyle(l),0===e&&(this.activeId=s,this.options.openSlideViewLeftHolder)&&l.appendChild(o),i.appendChild(l),this.application.get(s).then((t=>{t.attach(l,this.applet,{agentSegue:()=>(0,g._)(this,void 0,void 0,(function*(){return this.application.to(this.applet.id).then((()=>{var t;null!=(t=this.applet.slide)&&t.to(s)}))})),noSwipeModel:!0}),"instant"===r||0===e?(t.build(),0===e&&t.show()):"lazy"===r&&n((()=>{t.build()}),{timeout:3e3})}))})),e.appendChild(s),e.appendChild(i),e.appendChild(r),this.slideView=i,this.slideViewHolder=o,this.slideViewOverlay=r}}{}const G=!1===f(),X=w(),q=`\n  applet-viewport {\n    background: transparent !important;\n  }\n  modality-container {\n    display: flex;\n    height: 100%;\n    overflow-y: scroll !important;\n    scroll-behavior: smooth;\n    scroll-snap-type: y mandatory;\n    flex-direction: column;\n  }\n  modality-container::-webkit-scrollbar {\n    display: none;\n  }\n  modality-container::scrollbar {\n    display: none;\n  }\n  modality-placeholder {\n    position: relative;\n    display: block;\n    ${B}\n    scroll-snap-align: start;\n    scroll-snap-stop: always;\n    box-sizing: content-box;\n  }\n  modality-handle {\n    display: block;\n    position: absolute;\n    top: 100%;\n    height: 20px;\n    width: 100%;\n    z-index: 2;\n  }\n  modality-handle::before {\n    content: ' ';\n    display: block;\n    width: 36px;\n    height: 5px;\n    margin: 5px auto;\n    border-radius: 5px;\n    background: #777;\n    opacity: .5;\n  }\n  modality-handle:hover::before {\n    opacity: 1;\n  }\n  blocked-holder {\n    position: absolute;\n    top: 200px;\n    left: 0;\n    bottom: 200px;\n    width: 40px;\n    z-index: 5;\n    overflow-y: hidden;\n    overflow-x: scroll;\n    overscroll-behavior-y: none;\n    display: flex;\n    flex-flow: row-reverse;\n  }\n  blocked-holder::-webkit-scrollbar {\n    display: none;\n  }\n  blocked-holder::scrollbar {\n    display: none;\n  }\n  blocked-holder::before {\n    content: ' ';\n    display: flex;\n    min-width: 100vw;\n    height: 100%;\n  }\n`,Y=!1===(0,g.b)();class Q extends class extends class extends class extends class{constructor(t){this.switching=!1,this.scrolling=!1,this.backdropReducedScale=.1,this.backdropRotateX=-10,this.backdropPerspective=3e3,this.backdropBorderRadius=20,this.advanceDegree=800/window.innerHeight*.03,this.applet=t,this.application=this.applet.application,this.modalityContainer=document.createElement("modality-container"),this.appletViewport=this.applet.viewport,this.options=this.applet.config.sheetOptions,this.defaultToLarge="large"===(null==(t=this.options)?void 0:t.defaultCardSize)}}{get viewports(){return this.fromViewports&&this.activity||(this.fromViewports=this.application.segue.viewports,this.updateOverlapViewport()),this.fromViewports}get maxDegree(){var t;return this.maxDegreeCache||(t=null!=(t=null==(t=this.miniCard)?void 0:t.offsetHeight)?t:0,this.maxDegreeCache=1+t/this.contentContainer.offsetHeight)}get degree(){var t;return this.modalityContainer.scrollTop/Math.min(this.contentContainer.offsetHeight+(null!=(t=null==(t=this.miniCard)?void 0:t.offsetHeight)?t:0),this.modalityContainer.offsetHeight)}get visibility(){return!(this.degree<=.1)}get hasMiniCard(){return!!this.miniCard}get prevViewport(){return this.viewports[1]}get activity(){return this.applet.transforming||this.application.activityApplet===this.applet}setBackdropViewport(t){this.fromViewports||(this.fromViewports=this.viewports),this.fromViewports[1]=t}updateOverlapViewport(){var t=this.application.prevActivityApplet;null!=t&&t.modality&&this.setBackdropViewport(t.modality.viewports[1])}checkScrollStop(){return new Promise((t=>{const e=t=>{setTimeout((()=>this.scrolling?e(t):t()),100)};e((()=>t(!0)))}))}}{constructor(){super(...arguments),this.scrollingTimeoutId=-1,this.freezePosition=-1,this.fixSnapReset=!X,this.fallHeight=this.application.isFullscreen?40:0,this.slidingListener=this.sliding.bind(this)}switchSheet(t=1.5){return(0,g._)(this,void 0,void 0,(function*(){return this.activity?this.degree<=this.maxDegree/t?this.hide():this.rise():Promise.resolve()}))}switchOverlay(t=!1){this.modalityOverlay.style.display=t?"block":"none"}switchSmooth(t=!0){this.modalityContainer.style.scrollBehavior=t?"smooth":"auto"}switchSnap(t=!0){this.modalityContainer.style.scrollSnapType=t?"y mandatory":"none"}switchBackdropColor(t=!0){this.application.segue.applicationViewport.style.backgroundColor=t?null!=(t=null==(t=this.options)?void 0:t.backdropColor)?t:"#000":""}freezeSnap(){this.modalityPlaceholder.style.display="none",this.modalityContainer.scrollTop=0}activateSnap(){var t;return(0,g._)(this,void 0,void 0,(function*(){this.switchSmooth(!1),X||this.switchSnap(!1),this.modalityPlaceholder.style.display="flex",this.modalityContainer.scrollTop=this.modalityContainer.offsetHeight+(null!=(t=null==(t=this.miniCard)?void 0:t.offsetHeight)?t:0),yield l(0),this.switchSmooth(!0),X||this.switchSnap(!0)}))}rise(){var t;return(0,g._)(this,void 0,void 0,(function*(){if(this.switching)return this.processPromise;this.switching=!0,this.switchOverlay(!0);var e=this.modalityContainer.offsetHeight+(this.defaultToLarge?this.contentContainer.offsetHeight:0)+(this.miniCard&&this.degree>=1+(this.maxDegree-1)/2&&null!=(t=null==(t=this.miniCard)?void 0:t.offsetHeight)?t:0);return this.processPromise=this.scroller.snapTo(0,e).then((()=>{this.switching=!1,this.switchOverlay(!1)}))}))}fall(){return(0,g._)(this,void 0,void 0,(function*(){return this.switching?this.processPromise:(this.switching=!0,this.switchOverlay(!0),this.processPromise=this.scroller.snapTo(0,0).then((()=>(0,g._)(this,void 0,void 0,(function*(){this.switching=!1,this.switchOverlay(!1)})))))}))}hide(){return(0,g._)(this,void 0,void 0,(function*(){return this.switching?this.processPromise:(this.switching=!0,this.activity?(this.removeSlidingEvent(),this.segueTransition(!1),this.fall().then((()=>(0,g._)(this,void 0,void 0,(function*(){this.switching=!1,this.activity&&(yield this.application.segue.back())}))))):Promise.resolve())}))}segueTransition(t=!0){var e,i=this.prevViewport,s=!t||this.miniCard&&!this.defaultToLarge?0:1,o=null!=(o=null==(n=this.options)?void 0:n.maskOpacity)?o:.3,n=null==n?void 0:n.useFade;(null==(e=this.options)?void 0:e.stillBackdrop)||i.animate([{borderRadius:s*this.backdropBorderRadius+"px",transform:`\n            translate3d(0, ${s*this.fallHeight}px, -100px) \n            perspective(${this.backdropPerspective}px) \n            rotateX(${s*this.backdropRotateX}deg) \n            scale(${1-Math.max(s*this.backdropReducedScale,0)})\n          `}],{duration:500,delay:100,fill:"forwards"}).play(),this.modalityContainer.animate([{backgroundColor:`rgba(0, 0, 0, ${t?o:0})`}],{duration:500,delay:100,fill:"forwards"}).play(),n&&!t&&this.contentContainer.animate([{opacity:"1"}],{duration:0,fill:"forwards"}).play()}sliding(){if(this.activity){const r=this.degree;var t,e=this.maxDegree,i=this.prevViewport,s=null!=(s=null==(n=this.options)?void 0:n.maskOpacity)?s:.3,n=null==n?void 0:n.useFade;r>e?this.contentContainer.animate([{backgroundColor:`rgba(0, 0, 0, ${s+(1-s)*(r-e)/.2})`}],{duration:0,fill:"forwards"}).play():(e=this.miniCard?(r-1)/(e-1):r,t=null!=(t=null==(t=this.options)?void 0:t.stillBackdrop)?t:this.miniCard&&r<=1,this.activity&&i&&!t&&i.animate([{borderRadius:Math.min(e,1)*this.backdropBorderRadius+"px",transform:`\n            translate3d(0, ${e*this.fallHeight}px, -100px) \n            perspective(${this.backdropPerspective}px) \n            rotateX(${e*this.backdropRotateX}deg) \n            scale(${1-Math.max(e*this.backdropReducedScale,0)})\n          `}],{duration:0,fill:"forwards"}).play(),this.modalityContainer.animate([{backgroundColor:`rgba(0, 0, 0, ${s*Math.min(r,1)})`}],{duration:0,fill:"forwards"}).play(),n&&this.contentContainer.animate([{opacity:""+(e-2*(1-e))}],{duration:0,fill:"forwards"}).play(),this.scrolling=!0,clearTimeout(this.scrollingTimeoutId),this.scrollingTimeoutId=o((()=>{this.scrolling=!1,G&&this.degree===r&&(r<=.7?this.hide():this.rise())}),100),this.switching||r<=this.advanceDegree&&this.hide())}}bindSlidingEvent(){this.modalityContainer.addEventListener("scroll",this.slidingListener)}removeSlidingEvent(){this.modalityContainer.removeEventListener("scroll",this.slidingListener)}bindDragContentEvent(){var t=this.applet.contentDocument;if(t){const e={x:0,y:0,swipe:void 0},i=this.modalityContainer,s=i.offsetHeight/i.offsetWidth;t.addEventListener("touchstart",(t=>{t=(t=t.changedTouches)[0],e.x=t.pageX,e.y=t.pageY,e.swipe=void 0}),!0),t.addEventListener("touchend",(()=>(0,g._)(this,void 0,void 0,(function*(){e.swipe&&(e.swipe=!1,yield this.checkScrollStop())&&(this.switchSmooth(!0),this.switchSnap(!0),this.switchSheet(this.miniCard?2:1.25).then((()=>{this.switchOverlay(!1),this.switching=!1})))}))),!0),t.addEventListener("touchmove",(t=>{var o=(t=(t=t.changedTouches)[0]).pageX-e.x,n=t.pageY-e.y;this.switching||!1!==e.swipe&&(20<Math.abs(o)-Math.abs(n)&&Math.abs(n)<=10&&(e.swipe=!0,this.switchOverlay(!0),this.switchSmooth(!1),this.switchSnap(!1)),e.swipe)&&(i.scrollTop-=Math.ceil(o)*s,e.x=t.pageX,e.y=t.pageY)}),!0)}}bindBaseEvent(){this.applet.on("willShow",(()=>{this.switchBackdropColor(!0),this.application.segue.stackUp&&(this.fromViewports=void 0)})),this.applet.on("willSegueShow",(()=>{this.segueTransition(!0)})),this.applet.on("show",(()=>{this.bindSlidingEvent()})),this.applet.on("willHide",(()=>{this.removeSlidingEvent()})),this.applet.on("willSegueHide",(()=>{this.segueTransition(!1)})),this.applet.on("hide",(()=>{this.switchBackdropColor(!1)}))}freeze(){this.removeSlidingEvent(),!1===this.fixSnapReset&&(this.freezePosition=this.modalityContainer.scrollTop||this.contentContainer.offsetTop,this.modalityPlaceholder.style.display="none")}activate(){var t;!1===this.fixSnapReset&&-1!==this.freezePosition&&(this.modalityPlaceholder.style.display="block",t=this.freezePosition,this.modalityContainer.scrollTop=t,this.scroller.snapTo(0,t,0),this.freezePosition=-1,this.fixSnapReset=!0),this.bindSlidingEvent()}}{constructor(t){super(t),this.scroller=new O(this.modalityContainer),this.buildModalityOverlay(),null!=(t=t.viewport)&&t.appendChild(this.modalityContainer)}buildModalityOverlay(){var t=document.createElement("modality-overlay");t.style.cssText=`\n      position: fixed;\n      ${M}\n      z-index: 9;\n      display: none;\n    `,t.addEventListener("touchstart",(t=>{var e;(null==(e=this.options)||!e.stillBackdrop)&&this.degree<=this.advanceDegree&&this.activity&&this.hide(),t.stopPropagation(),t.preventDefault()}),!0),this.modalityOverlay=t}create(){var t=this.appletViewport,e=this.modalityContainer,i=e.firstChild,s=document.createElement("modality-placeholder"),n=document.createElement("modality-handle"),r=document.createElement("blocked-holder"),l=document.createElement("applet-container"),a=document.createElement("style"),h=!(null==(m=this.options)||!m.miniCardHeight||Y),p=y(null==m?void 0:m.miniCardHeight)||"0px",c=y(null==m?void 0:m.blockedHolderWidth)||"40px",d=y(null==m?void 0:m.top)||"60px",u=null==m?void 0:m.maskClosable,v=null==m?void 0:m.noHandlebar,m=y(null==m?void 0:m.borderRadius)||"16px";return a.innerHTML=q,l.style.cssText=`\n      position: relative;\n      border: 0px;\n      outline: 0px;\n      min-width: 100%;\n      min-height: calc(100% - ${d});\n      max-height: calc(100% - ${d});\n      border-top-left-radius: ${m};\n      border-top-right-radius: ${m};\n      scroll-snap-align: start;\n      scroll-snap-stop: always;\n      overflow: hidden;\n      transform: translate3d(0, 0, 500px);\n    `,t.appendChild(a),t.appendChild(r),t.appendChild(this.modalityOverlay),s.appendChild(n),r.style.width=c,i?e.insertBefore(s,i):e.appendChild(s),Y&&(e.style.cssText+="-webkit-overflow-scrolling: touch;"),h&&((d=document.createElement("modality-mini-card")).style.cssText=`\n        width: 100%;\n        min-height: calc(100% - ${p});\n        scroll-snap-align: start;\n        scroll-snap-stop: always;\n      `,e.appendChild(d),n.style.top=`calc(200% - ${p})`,this.miniCard=d),!1!==u&&(s.addEventListener("click",(()=>{this.hide()})),null!=(m=this.miniCard))&&m.addEventListener("click",(()=>{this.hide()})),v&&(n.style.display="none"),(null!=(t=null==(a=this.options)?void 0:a.swipeClosable)?t:(0,g.g)())&&o((()=>{this.bindDragContentEvent()}),10),this.bindBaseEvent(),e.appendChild(l),this.modalityPlaceholder=s,this.contentContainer=l}}{}h=(t,e)=>{const i=t.open;t.document.addEventListener("click",(t=>{t instanceof CustomEvent&&t.detail instanceof Event&&(t=t.detail);const s=e=>{var i;return{x:(null==(i=null==(i=t.changedTouches)?void 0:i[0])?void 0:i.pageX)||t.x,y:(null==(i=null==(i=t.changedTouches)?void 0:i[0])?void 0:i.pageY)||t.y,target:e}};var o=t=>({title:t.getAttribute("title")||"",preset:t.getAttribute("preset-effect")||"slide",cloneAs:t.getAttribute("clone-as")||void 0}),n=t.path||(null==(n=t.composedPath)?void 0:n.call(t))||[];n.splice(-3);for(const p of n){var r=null==(r=p.getAttribute)?void 0:r.call(p,"to-applet");if(r){const{cloneAs:t,title:i,preset:n}=o(p),[l,a]=r.split("?");if(t){e.get(l).then((o=>{o=o.model,Object.assign(o.config,{title:i,animation:n,level:e.activityLevel}),e.add(t,o),e.to(t,"?"+a,void 0,s(p))}));break}e.to(l,"?"+a,void 0,s(p));break}if("A"===p.tagName){const n=(r=p).href||String(r);if(n){if(t.stopPropagation(),t.preventDefault(),"_parent"===r.target||"_top"===r.target)return i(n),!1;var{cloneAs:l,title:a,preset:h}=o(p);e.pushWindow(n,a,h,l,s(r)).catch((()=>{i(n)}))}}}return!1}),!0),t.open=(t,s,o)=>"string"!=typeof t||s&&0!==s.indexOf("_")||o?i(t,s,o):(e.pushWindow(t,"").catch((()=>{i(t)})),null)};const J=t=>{const e=t.setTimeout,i=t.clearTimeout;var s=t.setInterval;const o=t.clearInterval,n={},r=(t.setBackgroundTimeout=e,t.setTimeout=(i,s,...o)=>{var r={timerLog:n,timerId:-1};return i=((t,e,i,s)=>()=>{const s=()=>{void 0!==i.timerLog[i.timerId]&&("function"==typeof t?t():"string"==typeof t&&new e.Function("return "+t)(),delete i.timerLog[i.timerId])};"complete"!==e.document.readyState?s():e===window?"frozen"!==window.applicationActiveState?s():window.addEventListener("message",(t=>{"application-active"===(null==(t=t.data)?void 0:t.type)&&s()})):"visible"===e.appletVisibilityState?s():e.addEventListener("message",(t=>{"applet-show"===(null==(t=t.data)?void 0:t.type)&&s()}))})(i,t,r),i=e(i,s,...o),n[i]=!0,r.timerId=i},t.clearTimeout=(...t)=>{var e=t[0];return e&&delete n[e],i(...t)},t.setTimeout.toString=()=>"setTimeout() { [native code] }",t.clearTimeout.toString=()=>"clearTimeout() { [native code] }",{});t.setBackgroundInterval=s,t.setInterval=(e,i,...s)=>{const o={timerId:-1,intervalId:-1},n=()=>{-1!==o.timerId&&!r[o.intervalId]||("function"==typeof e?e():"string"==typeof e&&new t.Function("return "+e)(),o.timerId=t.setTimeout(n,i,...s))};var l=o.intervalId=o.timerId=t.setTimeout(n,i,...s);return r[l]=o,l},t.clearInterval=(...e)=>{(e=e[0])&&(o(e),e=r[e])&&(t.clearTimeout(e.timerId),delete r[e.intervalId])},t.setInterval.toString=()=>"setInterval() { [native code] }",t.clearInterval.toString=()=>"clearInterval() { [native code] }"},K=(p=(t,e)=>{const i={element:null,oldFilterStyle:"",oldTransitionStyle:"",waitingToAddTimeId:-1},s=()=>{var t;i.element&&(clearTimeout(i.waitingToAddTimeId),null!=(t=i.element)&&t.style.filter&&(i.element.style.filter=i.oldFilterStyle),i.element.removeAttribute("tap-highlight"),o((()=>{var t;null!=(t=i.element)&&t.style.transition&&(i.element.style.transition=i.oldTransitionStyle),i.element=null,i.oldFilterStyle="",i.oldTransitionStyle=""}),100))};t.document.addEventListener("touchstart",(t=>{var n;const r=e?"string"==typeof e?e.split(" "):e:null,l=t.path||(null==(n=t.composedPath)?void 0:n.call(t))||[],a=(l.splice(-3),(()=>{var e,i;for(const t of l){if("A"===t.tagName)return t;if(null!=(e=t.children)&&e.length&&r){for(const e of r){if(0===e.indexOf("#")&&"#"+t.id===e)return t;if(0===e.indexOf(".")&&t.classList.length&&Object.values(t.classList).includes(e.slice(1)))return t;if(null!=(i=t.getAttribute)&&i.call(t,e))return t}return null}}var s=(null!=(s=null==(s=l[0])?void 0:s.children)&&s.length?l[0]:l[1])||t.target;return["DIV","A","IMG"].includes(s.tagName)?s:null})());if(a&&i.element!==a){if(i.element)return s();i.element=a,i.oldFilterStyle=a.style.filter,i.oldTransitionStyle=a.style.transition,a.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)",a.style.transition=i.oldTransitionStyle?i.oldTransitionStyle+", ":"all .1s ease",i.waitingToAddTimeId=o((()=>{i.element!==a||9e4<a.offsetWidth*a.offsetHeight||(a.style.filter=i.oldFilterStyle+" brightness(.8)",a.setAttribute("tap-highlight","true"))}),30)}})),t.document.addEventListener("touchmove",s),t.document.addEventListener("touchcancel",s),t.document.addEventListener("touchend",(()=>{t.setTimeout((()=>{s()}),300)}))},c=(t,e)=>{var{id:i,application:s}=e,o="function"==typeof(o=s.config.globalCSSVariables)?o():o;const n=t.document.documentElement.style,r=t=>{e.snapshot=null;for(const e in t)n.setProperty(e,t[e])},l=t=>{var e;r({"--application-safe-area-top":null!=(e=t[0])?e:t,"--application-safe-area-right":null!=(e=t[1])?e:t,"--application-safe-area-bottom":null!=(e=null!=(e=t[2])?e:t[0])?e:t,"--application-safe-area-left":null!=(e=null!=(e=t[3])?e:t[1])?e:t})};(t="function"==typeof(t=s.config.safeArea)?t():t)&&l(t),o&&r(o),!1===(0,g.b)()&&(n.cssText+="width: 100vw; height: 100vh; overflow: auto; -webkit-overflow-scrolling: touch;"),s.on("safeAreaChange",(t=>{l(t)}),i),s.on("globalCSSVariablesChange",(t=>{r(t)}),i)},(t,e)=>{var i=e.config;for(const e of Array.from(new Set(i.apply)))"smart-setTimeout"===e&&J(t);if("function"==typeof i.inject)try{i.inject(t,e)}catch(t){console.error("config > inject:",t)}});class Z extends L{setShadowView(t,e){["frameworks","system"].includes(this.rel)?(t.style.cssText="\n        position: fixed;\n        width: 100%;\n        z-index: 7;\n        pointer-events: none;\n      ",e.style.pointerEvents="all"):t.style.cssText=e.style.cssText="\n        min-width: 100%;\n        min-height: 100%;\n      "}createControlsView(){var t;return this.controls=new U(this.self),null==(t=this.controls)?void 0:t.create()}getContentContainer(){return"system"===this.rel?this.viewport:this.isModality?this.createModality():this.useControls?this.createControlsView():this.viewport}buildSlideView(t){return new Promise(((e,i)=>{var s;return this.slide?e():this.config.defaultSlideViewApplets?(s={openSlideViewLeftHolder:null==(s=this.config.openSlideViewLeftHolder)||s,slideViewSnapType:null!=(s=this.config.slideViewSnapType)?s:"x"},this.slide=new W(this.self,s,t),void e()):i()}))}buildContentImage(){var t,e,i;this.img||(e=this.viewport,i=document.createElement("applet-img"),!1===this.noShadowDom&&null!=(t=i.attachShadow)&&t.call(i,{mode:"open"}),e.appendChild(i),i.style.cssText=`\n      position: absolute;\n      ${M}\n      z-index: 2;\n      pointer-events: none;\n      background: ${this.color};\n      opacity: 1;\n      transition: opacity .3s;\n      contain: layout size;\n    `,this.img=i)}getPresetView(){var t;return null==(t=this.application.presetAppletsView)?void 0:t[this.id]}createContentView(){var t=document.createElement("define-applet");return this.application.defineApplet(t,this.id),t}getContentView(){var t=null!=(t=this.getPresetView())?t:this.createContentView();return"applet"===this.rel&&(t.style.cssText="\n        position: relative;\n        z-index: 1;\n        display: block;\n        width: 100%;\n        height: 100%;\n        max-width: 100%;\n        max-height: 100%;\n        overflow: auto;\n        background: transparent;\n      "),t}setContentViewColor(){this.contentView&&(this.contentView.style.background=this.color)}buildContentStructure(){var t;this.contentView||(this.contentView=this.getContentView(),this.contentSlot=this.contentView.getViewSlot(),t=this.getContentContainer(),this.config.defaultSlideViewApplets&&this.buildSlideView(t),t.appendChild(this.contentSlot))}createShadowView(){var t,e,i,s;return this.config.render?(i=document.createElement("applet-shadow"),s=document.createElement("applet-shadow-inner"),!1===this.noShadowDom&&null!=(t=i.attachShadow)&&t.call(i,{mode:"open"}),(i.shadowRoot||i).appendChild(s),null!=(e=(t=this.config).render)&&e.call(t,s),null!=(e=this.contentView)&&e.appendChild(i),this.setShadowView(i,s),Promise.resolve(i)):Promise.resolve(this.contentView)}createSandbox(t,e){return(0,g._)(this,void 0,void 0,(function*(){return this.sandbox=new C(t,null==e?void 0:e.join(" "),"src"),this.decorateSandbox(this.sandbox.sandbox),yield this.loadContentView(),this.sandbox.sandbox}))}createPortal(t){return(0,g._)(this,void 0,void 0,(function*(){var e=document.createElement("portal");return e.src=t,this.decorateSandbox(e),yield this.loadContentView(),e}))}createModality(){return this.modality=new Q(this.self),this.modality.create()}loadContentView(){return(0,g._)(this,void 0,void 0,(function*(){this.waitingForResponse().then((()=>{Promise.resolve()})).catch((()=>{Promise.reject()})),this.status.refreshing?o((()=>{Promise.resolve()}),2e3):Promise.resolve()}))}loadSourceContent(){return(0,g._)(this,void 0,void 0,(function*(){var t=this.contentView;if("portal"===this.viewType)return null!=t&&t.appendChild(this.view),Promise.resolve();const e=this.sandbox;if(!e)return Promise.resolve();this.uri?(e.setOnLoad((()=>{e.setOnUnload(this.loadSourceContent.bind(this)).catch((()=>{(0,g.t)(1201,"warn")})),Promise.resolve()})),e.setOnError((()=>Promise.reject())),e.enter(t),this.injectIntoContext(),this.injectIntoContext(2)):(e.enter(t),this.injectIntoContext(),e.append(yield this.source),this.injectIntoContext(2),e.setOnUnload(this.loadSourceContent.bind(this)).catch((()=>{(0,g.t)(1201,"warn")})),Promise.resolve())}))}injectIntoContext(t=1){var e;this.sameOrigin&&((e=this.contentWindow).__LATH_APPLICATION_AVAILABILITY__?(0,g.t)(1202,"warn"):2===t?(((t,e)=>{var i,{config:s,application:o}=e,n=Array.from(new Set(s.apply)),r=s.applyOptions||{};for(const e of n)switch(e){case"proxy-link":h(t,o);break;case"tap-highlight":p(t,null!=(i=null==(i=r[e])?void 0:i.selector)?i:"use-tap-highlight")}if("function"==typeof s.injectToDocument)try{s.injectToDocument(t,e)}catch(t){console.error("config > inject:",t)}if(e.components)for(const i of e.components)i(t);c(t,e)})(e,this),e.__LATH_APPLICATION_TUNNELING__=!0,null!=(t=this.config.apply)&&t.length&&(e.__LATH_APPLICATION_AVAILABILITY__=!0)):K(e,this))}loadMirrorImage(){this.status.refreshing||this.config.useMirroring&&!this.img&&(this.buildContentImage(),this.setImageContent(this.mirroringString||""))}setImageContent(t){var e=(e=this.img).shadowRoot||e;"string"==typeof t?e.innerHTML=t:e.appendChild(t)}removeMirrorImage(){if(this.img&&!this.status.refreshing){const t=this.img;o((()=>{var e;t.style.opacity="0",null!=(e=t.parentNode)&&e.removeChild(t),this.img=null}),300)}}decorateSandbox(t){t.style.cssText=`\n      position: absolute;\n      top: 0;\n      left: 0;\n      ${B}\n      border: 0;\n      outline: 0;\n    `}waitingForResponse(){return new Promise(((t,e)=>{this.loadSourceContent().then((()=>{var e;this.status.prerender=!0,null!=(e=this.events)&&e.load(this.self),this.trigger("load"),this.attachEvent(),o((()=>{t()}),0)})).catch((()=>{var t;null!=(t=this.events)&&t.loadError(this.self),this.trigger("loadError"),e()}))}))}createView(){return"shadow"===this.viewType?this.createShadowView():"portal"===this.viewType?this.createPortal(this.uri):this.createSandbox(this.uri,this.config.sandbox)}buildMainView(){return(0,g._)(this,void 0,void 0,(function*(){return this.cancelGuard(),this.expired?this.refresh():(this.view||(this.createTime=Date.now(),this.loadMirrorImage(),this.buildContentStructure(),this.injectIntoContext(),this.injectIntoContext(2),this.view=yield this.createView(),this.setContentViewColor(),this.removeMirrorImage()),Promise.resolve())}))}build(){return(0,g._)(this,void 0,void 0,(function*(){return yield this.buildMainView(),Promise.resolve()}))}refresh(){var t;return(0,g._)(this,void 0,void 0,(function*(){if(this.status.refreshing||!this.view)return Promise.reject();var e,i,s;this.status.refreshing=!0,"function"==typeof this.config.refresh?(yield this.config.refresh(),this.status.refreshing=!1,this.trigger("refreshing")):this.isPresetAppletsView||"applet"!==this.rel&&this.noSource?this.status.refreshing=!1:(e=this.contentView,i=this.contentSlot,s=this.view,e.setAttribute("applet-id",this.id+"-obsolete"),i.name=`applet-${this.id}-obsolete`,this.application.delPresetAppletsView(this.id),this.contentView=void 0,"applet"===this.rel&&this.noSource&&(this.config.source={src:location.href}),this.contentView=this.getContentView(),this.view=yield this.createView(),this.setContentViewColor(),i.name="applet-"+this.id,this.status.refreshing=!1,this.trigger("refreshing"),"IFRAME"===s.tagName&&this.unload(s),null!=(t=s.parentNode)&&t.removeChild(s),null!=(t=e.parentElement)&&t.removeChild(e))}))}captureShot(t=!0){return(0,g._)(this,void 0,void 0,(function*(){return!t&&this.snapshot&&this.snapshotTime===this.createTime?this.snapshot:(this.snapshotTime=this.createTime,i.e(219).then(i.bind(i,2219)).then((t=>(0,g._)(this,void 0,void 0,(function*(){return t.capture(this.self).then((t=>this.snapshot=t))})))))}))}}class tt extends Z{constructor(t,e,i){super(t,e,i),this.events.boot(this.self)}}const et=["animation","will-change"],it=(d=t=>(0,g._)(void 0,void 0,void 0,(function*(){var e=t.style,i={};for(let t=0;t<e.length;t++){var s,o=e[t];-1!==o.indexOf("transition")||et.includes(o)||(s=e.getPropertyValue(o),i[o]=[s,s])}return t.animate(i,{duration:0,fill:"forwards"}).finished})),u=t=>{var e;const i=[];return null!=(e=t.getAnimations)&&e.call(t).forEach((t=>{i.push(t.finished)})),Promise.all(i)},w());class st extends class extends class extends class extends class extends class{constructor(t,e){this.id="",this.prevId="",this.param="",this.relativeViewport=document.createElement("relative-windows"),this.absoluteViewport=document.createElement("absolute-windows"),this.fixedViewport=document.createElement("fixed-windows"),this.applicationViewport=document.createElement("application-windows"),this.target=this.relativeViewport,this.resetBaseStyleText=R,this.application=t,this.root=e.root||document.body,this.zIndex=e.zIndex||Number.MAX_SAFE_INTEGER,this.setupViewport()}resetBaseStyle(t=""){this.resetBaseStyleText=R+t}setupViewport(){this.relativeViewport.id="relative-viewport",this.absoluteViewport.id="absolute-viewport",this.resetViewport(),this.fixedViewport.id="fixed-viewport",this.fixedViewport.style.cssText="\n      width: 100%;\n      height: 0;\n      max-height: 0;\n      z-index: 3;\n      overflow: hidden;\n      contain: layout size;\n    ",this.applicationViewport.style.cssText=`\n      position: fixed;\n      ${M}\n      overflow: hidden;\n      z-index: ${this.zIndex};\n      contain: layout size;\n    `,this.applicationViewport.appendChild(this.relativeViewport),this.applicationViewport.appendChild(this.absoluteViewport),this.applicationViewport.appendChild(this.fixedViewport),this.root.appendChild(this.applicationViewport)}resetViewport(t){var e=`\n      position: fixed;\n      ${M}\n      overflow: hidden;\n      contain: layout size;\n      ${this.resetBaseStyleText}\n    `;this.relativeViewport.style.cssText=`\n      ${e}\n      z-index: 1;\n      transform: translate3d(0, 0, 0);\n    `,this.absoluteViewport.style.cssText=`\n      ${e}\n      z-index: 2;\n      transform: ${t?"translate3d(0, 0, 0)":"translate(200%, 200%)"};\n    `}}{constructor(t,e){super(t,e),this.prevHistoryStep=0,this.historyIndex=history.length,this.historyShadowLength=history.length,this.oneHistoryIndex=0,this.historyDirection=0,this.backoutCount=0,this.sessionHistory=[],this.silentObserver=void 0,this.defaultURLPath=location.pathname,this.defaultURLSearch=location.search,this.historyBreakCallback=null,this.bindHistoryState()}get fromHistoryForward(){return-1===this.prevHistoryStep&&1===this.historyDirection}get fromHistoryBack(){return-1===this.prevHistoryStep&&-1===this.historyDirection}get historyState(){return"loading"===document.readyState?this.sessionHistory[this.oneHistoryIndex]:history.state}get isOverscrollHistoryNavigation(){var t,e;return!(!this.fromHistoryBack&&!this.fromHistoryForward||(e=-1!==(t=this.application.overscrollHistoryNavigation).type.indexOf("wipe")?300:200,Date.now()-t.moment>e))}bindHistoryState(){addEventListener("popstate",(t=>{this.popstate(t.state)}),!1),addEventListener("hashchange",(()=>{this.observeSilent()}),!1)}observeSilent(t=10){this.options.oneHistory||("loading"===document.readyState&&(t=30),clearTimeout(this.silentObserver),t&&(this.silentObserver=setTimeout((()=>(0,g._)(this,void 0,void 0,(function*(){var e=this.historyState||history.state||this.application.route;(e=decodeURIComponent(e.id))&&decodeURIComponent(e)!==this.id&&(yield this.popstate(this.historyState).catch((()=>{clearTimeout(this.silentObserver)}))),this.observeSilent(t--)}))),2e3)))}popstate(t){return(0,g._)(this,void 0,void 0,(function*(){var{historyIndex:e=this.historyShadowLength}=null!=t?t:{};e===this.historyIndex?this.historyDirection=0:e>this.historyIndex?this.historyDirection=1:this.historyDirection=-1,null===t?(this.historyDirection=-1,this.historyIndex=this.historyIndex-1):this.historyIndex=e,yield this.toHistory(t),this.observeSilent(20)}))}back(t){return(0,g._)(this,void 0,void 0,(function*(){return this.backFromType=t,this.backTo().catch((()=>{this.backFromType=void 0}))}))}backTo(){var t;return this.options.oneHistory?(t=this.sessionHistory[this.oneHistoryIndex-1])?(this.historyDirection=-1,this.oneHistoryIndex=this.oneHistoryIndex-1,this.toHistory(t)):Promise.reject():(history.back(),this.observeSilent(20),Promise.resolve())}forward(){var t;return this.options.oneHistory?(t=this.sessionHistory[this.oneHistoryIndex+1])?(this.historyDirection=1,this.oneHistoryIndex=this.oneHistoryIndex+1,this.toHistory(t)):Promise.reject():(history.forward(),this.observeSilent(20),Promise.resolve())}getSearch(t=""){return(t=new URL(t,location.origin+this.defaultURLPath+this.defaultURLSearch)).pathname+t.search}pushState(t="",e="",i=""){t=encodeURIComponent(t),i=this.getSearch(i);var s=this.historyShadowLength,o={id:t,title:e,time:Date.now(),search:i,historyIndex:s};if(this.observeSilent(20),0!==this.sessionHistory.length&&(this.sessionHistory.length=this.oneHistoryIndex+1),this.sessionHistory.push(o),this.oneHistoryIndex=this.sessionHistory.length-1,this.options.oneHistory)return this.replaceState(t,e,i);history.pushState(o,e,i+"#"+t),this.historyIndex=this.historyShadowLength=s+1,this.historyDirection=1}replaceState(t="",e="",i=""){t=encodeURIComponent(t),i=this.getSearch(i);var s=this.historyShadowLength,o={id:t,title:e,time:Date.now(),search:i,historyIndex:s};history.replaceState(o,e,i+"#"+t),this.historyIndex=s,this.historyDirection=0}requestRegisterHistory(t="",e="",i=""){if("portal"!==this.applet.viewType){if(this.options.oneHistory,-1===this.prevHistoryStep)return this.replaceState(t,e,i);this.fromHistoryBack||this.fromHistoryForward||this.pushState(t,e,i)}}toHistory(t){var e,i;return(0,g._)(this,void 0,void 0,(function*(){var s,o,n=this.options,r=t||history.state||this.application.route,l=decodeURIComponent(r.id)||n.index||"frameworks",a=(r=r.search,yield this.application.get(l));if(a){if(!this.checkSingleLock())return this.backoutCount=0,s=null!=(i=a.config.level)?i:0,o=null!=(i=this.applet.config.level)?i:0,n.singleFlow&&0!==s&&o<=s?this.back():(this.isOverscrollHistoryNavigation&&null!=(i=this.historyBreakCallback)&&i.call(this),this.application.segue.to(l,r,-1).then((()=>{this.backFromType=void 0})),this.application.trigger("back",a),Promise.resolve());this.backoutCount++,!0===(null==(e=(i=this.options).holdBack)?void 0:e.call(i,this.backoutCount))&&(this.pushState(l,a.config.title,r),this.application.trigger("exit",{backoutCount:this.backoutCount}))}}))}checkSingleLock(){return!(!this.options.singleLock||0!==this.applet.config.level||-1!==this.historyDirection)}bindHistoryBreak(t){this.historyBreakCallback=t}}{constructor(){super(...arguments),this.hasAnimation=!1,this.superSwitch=!1,this.viewportLevelLength=2,this.historyIndexOfStartOverlaying=void 0,this.fromOverscrollHistoryNavigation=!1}get isEntryApplet(){return!this.prevApplet||"applet"!==this.prevApplet.rel}get immovable(){return this.superSwitch||!this.hasAnimation||this.countercurrent}get fallbackState(){var t;return 1===this.appletGroup.length?-1:!this.applet.config.free&&null!=(t=this.prevApplet)&&t.config.free||(!this.applet.config.free||null!=(t=this.prevApplet)&&t.config.free)&&!this.stackUp?1:0}get stackUp(){var t;return!(!this.applet.config.free&&this.superSwitch)&&this.applet.viewLevel>=(null!=(t=null==(t=this.prevApplet)?void 0:t.viewLevel)?t:0)}get countercurrent(){return 1===this.fallbackState||this.fromHistoryBack}get viewports(){var t;return this.superSwitch?[this.applet.config.free?this.absoluteViewport:this.relativeViewport,null!=(t=this.prevApplet)&&t.config.free?this.absoluteViewport:this.relativeViewport]:[this.applet.viewport,null==(t=this.prevApplet)?void 0:t.viewport]}get isInseparableLayer(){return!this.prevApplet||"frameworks"===this.prevApplet.rel&&!this.prevApplet.slide}checkSwitchViewport(t=this.prevApplet,e=this.applet){return!!e.config.free!=!!(t=t||e).config.free}getSuperViewport(t=this.applet){return"system"===t.rel?this.fixedViewport:t.config.free?this.absoluteViewport.shadowRoot||this.absoluteViewport:this.relativeViewport.shadowRoot||this.relativeViewport}}{checkAnimationNamed(){return!!this.getAnimationNames()}checkNativeAnimation(){var t=this.getAnimationNames();return"string"==typeof t&&["slide","slide-left"].includes(t)}getAnimationNames(){var t;return!(this.options.index&&this.applet.isFullscreen&&this.isEntryApplet||this.fromOverscrollHistoryNavigation||"controls"===this.backFromType)&&(!0===(t=null!=(t=null==(t=this[this.countercurrent?"prevApplet":"applet"])?void 0:t.config.animation)?t:"slide")||"inherit"===t?this.options.defaultAnimation:t)}getAnimationGroup(){return(0,g._)(this,void 0,void 0,(function*(){let t;var e=this.getAnimationNames();if("string"==typeof e)t=yield this.getAnimationByName(e);else if(Array.isArray(t)&&"function"!=typeof e[0])return;return t}))}getAnimationOneSide(t){return(0,g._)(this,void 0,void 0,(function*(){var e=yield this.getAnimationGroup();if(0<=t)switch(typeof e){case"function":return e;case"object":return e[2===e.length?t:0];default:return}}))}preloadAnimation(t){t=null!=(t=null==(t=null==t?void 0:t.config)?void 0:t.animation)?t:"slide",this.getAnimationByName(t)}getAnimationByName(t){return(0,g._)(this,void 0,void 0,(function*(){switch(t){case"popup":return new Promise(((t,e)=>{i.e(651).then(i.bind(i,6651)).then((e=>{e=e.default,t([e,e])})).catch(e)}));case"grow":return new Promise(((t,e)=>{i.e(352).then(i.bind(i,3352)).then((e=>{e=e.default,t(e)})).catch(e)}));case"flip":return new Promise(((t,e)=>{i.e(697).then(i.bind(i,2697)).then((e=>{e=e.default,t([e(4),e(4)])})).catch(e)}));case"flip-left":return new Promise(((t,e)=>{i.e(697).then(i.bind(i,2697)).then((e=>{e=e.default,t([e(3),e(3)])})).catch(e)}));case"flip-down":return new Promise(((t,e)=>{i.e(697).then(i.bind(i,2697)).then((e=>{e=e.default,t([e(2),e(2)])})).catch(e)}));case"flip-right":return new Promise(((t,e)=>{i.e(697).then(i.bind(i,2697)).then((e=>{e=e.default,t([e(1),e(1)])})).catch(e)}));case"flip-up":return new Promise(((t,e)=>{i.e(697).then(i.bind(i,2697)).then((e=>{e=e.default,t([e(0),e(0)])})).catch(e)}));case"fade":return new Promise(((t,e)=>{i.e(194).then(i.bind(i,6194)).then((e=>{e=e.default,t([e(1),e(0)])})).catch(e)}));case"zoom":return new Promise(((t,e)=>{i.e(300).then(i.bind(i,7300)).then((e=>{e=e.default,t([e(1),e(0)])})).catch(e)}));case"slide-right":return new Promise(((t,e)=>{i.e(578).then(i.bind(i,8578)).then((e=>{e=e.default,t([e(3),e(1)])})).catch(e)}));case"slide-up":return new Promise(((t,e)=>{i.e(578).then(i.bind(i,8578)).then((e=>{e=e.default,t([e(2),e(0)])})).catch(e)}));case"slide-down":return new Promise(((t,e)=>{i.e(578).then(i.bind(i,8578)).then((e=>{e=e.default,t([e(0),e(2)])})).catch(e)}));default:if(this.applet&&this.options)return this.applet.config.modality?void(0,g.t)(1007):new Promise(((t,e)=>{(this.options.swipeModel?i.e(986).then(i.bind(i,3986)).then((e=>{e=e.default,t([e,e])})):i.e(578).then(i.bind(i,8578)).then((e=>{e=e.default,t([e(1),e(3)])}))).catch(e)}))}}))}}{constructor(t,e){super(t,e),this.promiseId="",this.windowSet=[],this.promiseQueue=[],this.promiseParamQueue=[],this.delayDynamicImport()}to(...t){return(0,g._)(this,void 0,void 0,(function*(){var e=this.next()||this.promise(...t);return this.pushPromise(this.bindPromiseDone(e),t)}))}attachAppletViewport(t){var e;t.viewport||((e=document.createElement(t.rel+"-viewport")).setAttribute("name",t.id),t.attach(e),this.getSuperViewport(t).appendChild(e))}delayDynamicImport(){n((()=>{(0,g.l)()}))}setStepState(t){this.target=this.getSuperViewport(),this.superSwitch=this.checkSwitchViewport(),this.fromHistoryBack||this.applet.setLevel(1+this.viewportLevelLength++),this.hasAnimation=!t&&this.checkAnimationNamed()}resetAppletViewport(t,e=this.immovable){return(0,g._)(this,void 0,void 0,(function*(){var i=t.viewport,s=["frameworks","system"].includes(t.rel);yield u(i),i.style.cssText="",s||(i.style.cssText=`\n      position: absolute;\n      ${M}\n      z-index: ${t.viewLevel};\n      transition-duration: 0ms;\n      transition-delay: 0ms;\n      transition-property: all;\n      transform: ${e?"translate(0, 0)":"translate(0, 200%)"};\n      backface-visibility: hidden;\n      overflow: hidden;\n      contain: layout size;\n      ${this.resetBaseStyleText}\n    `,yield d(i))}))}prev(){return this.promiseQueue[0]}next(){var t=this.prev(),e=()=>this.bindPromiseDone(this.promise(...this.promiseParamQueue[0]));if(t)return t.then(e).catch(e)}pushPromise(t,e){return this.promiseParamQueue.push(e),this.promiseQueue.push(t),t}shiftPromise(){this.promiseParamQueue.shift(),this.promiseQueue.shift()}bindPromiseDone(t){return(0,g._)(this,void 0,void 0,(function*(){const e=()=>this.shiftPromise();return t.then(e).catch((()=>{e(),this.to404()}))}))}limit(t){var e,i=t.id,s=Math.max((null==(s=null==this?void 0:this.options)?void 0:s.limit)||3,2),o=this.windowSet.indexOf(i);"applet"===this.applet.rel&&!0!==this.applet.config.background&&(-1!==o&&this.windowSet.splice(o,1),t.parentApplet||this.windowSet.push(i),this.windowSet.length>s)&&null!=(e=this.application.applets[this.windowSet.splice(0,1)[0]])&&e.destroy()}destroy(t){t.transient&&-1===this.prevHistoryStep?this.application.del(t.id).then((()=>{var e=this.windowSet.indexOf(t.id);this.windowSet.splice(e,1)})):t.guarding().then((e=>{e||t.destroy().then((()=>{var e=this.windowSet.indexOf(t.id);this.windowSet.splice(e,1)}))}))}to404(){return(0,g._)(this,void 0,void 0,(function*(){return this.options.notFound?this.promise(this.options.notFound,this.param+(-1===this.param.indexOf("?")?"?":"&")+"__notFoundId="+this.promiseId,this.prevHistoryStep):Promise.resolve()}))}promise(...t){var e;return(0,g._)(this,void 0,void 0,(function*(){var[i,s="",o=1,n,r]=t;if(!i)return Promise.resolve();this.promiseId=i;var l=this.id;const a=this.application.applets[i];var h=(l=this.application.applets[l])?[a,l]:[a];return a?i===this.id?Promise.resolve():null!=(e=a.mountBehavior)&&e.agentSegue?null==(e=a.mountBehavior)?void 0:e.agentSegue():(this.prevId=this.id,this.id=i,this.param=this.getSearch(s),this.applet=a,this.prevPrevApplet=this.prevApplet,this.prevApplet=l,this.appletGroup=h,this.prevHistoryStep=o,this.touches=n,this.fromOverscrollHistoryNavigation=this.isOverscrollHistoryNavigation,this.setStepState(r),this.attachAppletViewport(a),this.resetAppletViewport(a),this.requestRegisterHistory(i,a.config.title,s),a.setActionOrigin(n),yield a.setParam(this.param),yield a.build(),this.start().then((()=>(0,g._)(this,void 0,void 0,(function*(){return this.transform().then((t=>(0,g._)(this,void 0,void 0,(function*(){var e;yield this.end(t),this.limit(a),this.application.pullDependencies(null==(e=a.config)?void 0:e.prerender).then((()=>{this.application.trigger("prerenderComplete")})),a.config.title&&(document.title=a.config.title)}))))}))))):this.application.get(i).then((()=>this.promise(...t)))}))}pos(){let t=(null==(o=this.touches)?void 0:o.x)||0,e=(null==(o=this.touches)?void 0:o.y)||0,i="center",s="center";var o=this.relativeViewport.offsetWidth,n=this.relativeViewport.offsetHeight;return t&&e&&(s=[t,e],t<o/4?t=0:t>3*o/4&&(t=o),e<n/4?e=0:e>3*n/4&&(e=n),i=[t,e]),{x:t,y:e,width:o,height:n,attach:i,origin:s}}modulation(t){const e=this.viewports,i=this.fallbackState,s=this.countercurrent,o=this.pos();return new Promise(((n,r)=>{(0,g.l)().then((()=>{var r={x:o.x,y:o.y,view:e,width:o.width,height:o.height,viewports:[this.relativeViewport,this.absoluteViewport],applets:this.appletGroup,reverse:s,direction:s?-1:1,fallbackState:i,historyDirection:this.historyDirection,origin:o.origin,attach:o.attach,touches:this.touches,swipeTransitionType:null!=(r=this.options.swipeTransitionType)?r:"zoom",callback:t};n(r)})).catch((()=>{r()}))}))}transform(){return(0,g._)(this,void 0,void 0,(function*(){return this.hasAnimation?new Promise((t=>{this.getAnimationOneSide(this.fallbackState).then((e=>{this.bindHistoryBreak((()=>t(!1))),this.modulation(t).then((i=>{var s;if(!e)return t(!1);null!=(s=this.prevApplet)&&s.willSegueHide(),this.applet.willSegueShow(),o((()=>{var s=e(i);s instanceof Promise&&s.then(t),o((()=>t(!1)),2500)}),0)})).catch((()=>{t(!1)}))})).catch((()=>t(!1)))})):Promise.resolve(!1)}))}start(){return(0,g._)(this,void 0,void 0,(function*(){this.application.activate(!1),this.application.trigger("transformStart",this.appletGroup);var t=this.applet.events.transformStart;if("function"==typeof t&&"break"===t(this.applet))return Promise.reject();this.applet.willShow(),this.prevApplet&&(this.prevApplet.willHide(),this.prevApplet.controls)&&"default"===this.prevApplet.swipeModel&&this.prevApplet.controls.activate(),this.applet.controls&&(this.applet.controls.disappearImmediately(),this.isInseparableLayer?(this.applet.controls.disable(),this.applet.controls.freeze()):this.checkNativeAnimation()||this.applet.controls.freeze()),this.hasAnimation&&!this.superSwitch||this.applet.viewport&&"applet"===this.applet.rel&&(yield this.applet.viewport.animate([{transform:"translate(0, 0)"}],{duration:0,fill:"forwards"}).finished),Promise.resolve()}))}end(t=!1){var e;return(0,g._)(this,void 0,void 0,(function*(){(this.applet.isFullscreen||this.countercurrent)&&(this.superSwitch&&(yield this.switchViewport()),yield this.switchApplet(t)),this.applet.controls&&("default"===this.applet.swipeModel?this.applet.controls.freeze():this.applet.controls.activate()),it&&(1===this.prevHistoryStep&&null!=(e=this.prevApplet)&&e.modality&&this.prevApplet.modality.freeze(),this.applet.modality)&&(i=this.applet,null!=(e=i.modality))&&e.activate(),this.applet.show(),this.prevApplet&&this.prevApplet.hide();var i=this.applet.events.transformEnd;"function"==typeof i&&i(this.applet),this.application.activate(!0),this.application.trigger("transformEnd",this.appletGroup)}))}switchViewport(){var t;return(0,g._)(this,void 0,void 0,(function*(){yield u(this.relativeViewport),yield u(this.absoluteViewport),this.resetViewport(null==(t=null==(t=this.applet)?void 0:t.config)?void 0:t.free),yield d(this.relativeViewport),yield d(this.absoluteViewport)}))}switchApplet(t=!1){return(0,g._)(this,void 0,void 0,(function*(){var e;this.prevApplet&&(t||("applet"===this.prevApplet.rel&&(e=(this.applet.useControls||this.applet.config.modality)&&!this.countercurrent||this.prevApplet.config.modality&&this.fromHistoryBack,this.prevApplet.viewport)&&(yield u(this.prevApplet.viewport),this.prevApplet.viewport.style.transform=e?"translate(0, 0)":"translate(0, 200%)",yield d(this.prevApplet.viewport)),this.resetAppletViewport(this.applet,!0)),this.prevApplet.viewport&&(this.prevApplet.viewport.style.transitionDuration="0ms"),!1!==this.prevApplet.config.background||this.applet.config.modality?this.prevApplet.hide():this.destroy(this.prevApplet),this.superSwitch)&&this.prevPrevApplet&&this.prevPrevApplet!==this.applet&&this.resetAppletViewport(this.prevPrevApplet,!1)}))}}{setup(t){this.options=t}}v=t=>{window.addEventListener("message",(e=>{if(e.source!==window){var{action:e,data:i}=e.data;switch(e){case"to":t.segue.to(i.applet,i.query,i.history);break;case"back":t.segue.back();break;case"forward":t.segue.forward();break;case"pushWindow":t.pushWindow(...i)}}}))},m=Object.freeze({__proto__:null,Application:class extends T{constructor(t={}){super(),this.tunneling=!1,this.pullRefreshHolder={holder:null,spinner:null,holdLayer:null},this.working=!1,this.root=t.root,this.appletsSpace=t.appletsSpace,this.tunneling=parent!==window&&!!t.tunneling&&!!window.__LATH_APPLICATION_TUNNELING__,this.segue=new st(this,t),this.presetConfig=t,this.to=this.segue.to.bind(this.segue),this.activateTunneling(),v(this),this.setBaseStyle()}setBaseStyle(){var t=document.createElement("style");t.innerHTML="\n  html, body {\n    width: 100vw;\n    height: 100vh;\n    min-width: 100vw;\n    min-height: 100vh;\n    max-width: 100vw;\n    max-height: 100vh;\n    margin: 0px;\n    padding: 0px;\n    overflow: hidden;\n  }\n  body::-webkit-scrollbar {\n    display: none;\n  }\n  body::scrollbar {\n    display: none;\n  }\n  define-applet {\n    display: block;\n  }\n",document.head.appendChild(t)}add(t,e){var i,s,o,n;return this.applets[t]||(this.config&&(({appletManifestProcess:i,animationUnderUntouchable:n="fade",modalityUnderUntouchable:s="overlay"}=this.config),o=null!=(o=e.config.animationUnderUntouchable)?o:n,n=null!=(n=e.config.modalityUnderUntouchable)?n:s,i&&(e=i(e)||e),"ontouchend"in document||(o&&(e.config.animation=o),e.config.modality&&(e.config.modality=n))),this.applets[t]=new tt(t,e,this))}del(t){return new Promise(((e,i)=>{var s=this.applets[t];s.view?s.destroy().then(e).catch(i):e(!0),delete this.applets[t]}))}get(t){var e;return(0,g._)(this,void 0,void 0,(function*(){if("object"==typeof this.applets[t])return Promise.resolve(this.applets[t]);var i=this.options.applets[t];switch(typeof i){case"function":return Promise.resolve(this.add(t,yield this.promiseApplet(i)));case"object":return Promise.resolve(this.add(t,i));case"string":return this.verifyAppletSrcLegitimacy(t)&&null!=(e=yield this.createAppletByURL(t,{},t))?e:Promise.reject();default:return Promise.reject()}}))}defineApplet(t,e){t.setAttribute("applet-id",e),this.appletsSpace.appendChild(t),!0===function(){var t=(0,g.g)();return!!(t&&t[0]<=13)}()&&o((()=>{t.slot="none",o((()=>{t.slot="applet-"+e}),0)}),0)}cloneAsNewApplet(t,e,i={}){return e?(i=Object.assign({},t.model.config,i),this.add(e,Object.assign({},t.model,{config:i}))):t}getAppletByURL(t){return(0,g._)(this,void 0,void 0,(function*(){if((e=this.config.transfer)&&"string"==typeof(e=e(t)))return this.get(e);var e,i=this.applets,s=(e=this.resolveURL(t)).origin+e.pathname;for(const e in i){var o=i[e],n=o.config.capture;if("applet"===o.rel){if(n&&this.captureAppletSrc(t,n))return o;if(o.uri===s)return o}}}))}createAppletByURL(t,e,i){var s;return(0,g._)(this,void 0,void 0,(function*(){var o=decodeURIComponent(t),n=this.applets;return(n=null!=(s=n[o])?s:yield this.getAppletByURL(t))?i?this.cloneAsNewApplet(n,i,e):n:(n=!0!==this.config.disableTransient,this.add(o,{config:Object.assign({title:"",rel:"applet",free:!0,source:{src:t},background:"auto",timeout:n?0:null!=(s=this.config.transientTimeout)?s:6e4,animation:"inherit",color:this.config.color,transient:n},e)}))}))}pushWindow(t,e="",i="slide",s,o){var n;return(0,g._)(this,void 0,void 0,(function*(){var r,l;return this.verifyAppletSrcLegitimacy(t)?this.tunneling?(parent.postMessage({action:"pushWindow",data:[t,e,i,s,o]},"*"),Promise.resolve()):-1===(r=this.resolveURL(t)).protocol.indexOf("http")?Promise.reject("Unknown"):(r=r.search,(l=yield this.createAppletByURL(t,{title:e,animation:i,level:this.activityLevel},s))?this.segue.to(l.id,null!=(n=null==(n=l.config)?void 0:n.source)&&n.html?r:"",1,o):Promise.reject()):Promise.reject("Illegal")}))}pullDependencies(t=[],e=!0){var i=[];for(const s of t)i.push(new Promise(((t,i)=>{this.get(s).then((i=>{e?i.prerender().then(t).catch(t):t("")})).catch(i)})));return Promise.all(i)}updateSafeArea(t){this.trigger("safeAreaChange",t)}updateGlobalCSSVariables(t){this.trigger("globalCSSVariablesChange",t)}refresh(){for(const e in this.applets){var t=this.applets[e];t.visibility?t.refresh():t.status.requestRefresh=!0}}createAppSwitcher(){i.e(256).then(i.bind(i,6256)).then((({AppSwitcher:t})=>{this.appSwitcher=new t(this)})).catch((t=>{console.warn(t)}))}createPullToRefreshHolder(){i.e(461).then(i.bind(i,7461)).then((t=>{this.pullRefreshHolder=t.createPullToRefreshHolder(this.properties.darkTheme,this.segue.fixedViewport),this.trigger("pullToRefreshAvailable")})).catch((t=>{console.warn(t)}))}mountSystem(){this.options.applets.system&&this.get("system").then((t=>{this.segue.attachAppletViewport(t),t.build().then((()=>this.trigger("systemDidMount",t)))}))}mountFramework(){return(0,g._)(this,void 0,void 0,(function*(){return this.get("frameworks").then((t=>{var e=this.route;const i=t.config;var s=i.index||g.P.defaultApplet||"",o=i.preIndex;const n=e.id||s;return this.config=i,this.segue.setup({singleFlow:i.singleFlow,singleLock:i.singleLock,index:s,defaultIndex:n,oneHistory:i.oneHistory,notFound:i.notFound||s,limit:Math.max(i.limit||7,2),defaultAnimation:i.animation,holdBack:i.holdBack,swipeTransitionType:i.swipeTransitionType,swipeModel:t.swipeModel}),Promise.all([this.segue.to("frameworks",void 0,-1).then((()=>{i.pullToRefresh&&this.createPullToRefreshHolder(),i.appSwitcher&&this.createAppSwitcher(),this.trigger("frameworksDidMount",t),window.dispatchEvent(new CustomEvent("lathApplicationReady",{detail:{application:this}}))})),this.mountFirstApplet(n,s,o,i.oneHistory).then((()=>{this.segue.id!==n&&this.resolveURL(n).origin!==location.origin&&this.pushWindow(n)}))])})).catch((()=>{(0,g.t)(1007)}))}))}createCloneApplet(t){return(0,g._)(this,void 0,void 0,(function*(){var e=t.split("^");if(1===e.length)return Promise.resolve();yield this.get(e[1]).then((e=>{e=e.model,Object.assign(e.config,{level:this.activityLevel}),this.add(t,e)})).catch((()=>{(0,g.t)(1008,"error",t)}))}))}lineUpApplet(t,e,i){return(0,g._)(this,void 0,void 0,(function*(){return new Promise((s=>{this.get(t).then((o=>{if(o=o.config.antecedentApplet){for(const t of o)this.segue.to(t,e,1);this.segue.to(t,e,1)}else this.segue.to(t,e,i);s()})).catch((()=>{this.segue.to(t,e,-1),s()}))}))}))}mountFirstApplet(t,e,i,s){return(0,g._)(this,void 0,void 0,(function*(){var o;return t!==g.P.defaultApplet&&(o=(0,g.c)(g.P.defaultApplet)).parentNode&&o.parentNode.removeChild(o),yield this.createCloneApplet(t),s?(this.segue.pushState(e||"frameworks"),t?this.lineUpApplet(t,location.search,1):Promise.resolve()):t!==e&&t!==i?(e||i||this.segue.pushState("frameworks"),i&&this.segue.pushState(i),t?this.lineUpApplet(t,location.search,this.exists?-1:1):Promise.resolve()):t?this.lineUpApplet(t,location.search,-1):Promise.resolve()}))}activateTunneling(){window.addEventListener("message",(t=>{if(t.source!==window){t=t.data.type;var e=this.activityApplet;switch(t){case"applet-show":null!=e&&e.show();break;case"applet-hide":null!=e&&e.hide();break;case"applet-will-show":null!=e&&e.willShow();break;case"applet-will-hide":null!=e&&e.willHide();break;case"application-active":null!=this&&this.activate(!0);break;case"application-frozen":null!=this&&this.activate(!1)}}}))}subscribeSubAppMessages(){window.addEventListener("message",(t=>{var e,i;t.source!==window&&(({type:e,data:i}=t.data),"overscrollHistoryNavigationStatusChange"===e&&(this.overscrollHistoryNavigation.moment=i[0],this.overscrollHistoryNavigation.type=i[1]),parent.postMessage(t.data,"*"))}))}start(){return(0,g._)(this,void 0,void 0,(function*(){return this.options.applets?this.working?Promise.reject("repeat"):(this.working=!0,this.setExists(),this.mountFramework().then((()=>{this.trigger("firstAppletDidMount"),this.mountSystem()}))):Promise.reject("Please configure the applet first!")}))}}})}}]);